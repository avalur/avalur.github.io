[
  {
    "id": "problem_6",
    "round": "Day 2",
    "variants": [
      "Let  \n\n\u2003g:(0,\u221e) \u2192 \u211d,\u2003 g(x)= (f(x)-k)/x .\u2003\u2003(1)\n\nBecause f is continuously differentiable on (0,\u221e), g is continuous on (0,\u221e) and differentiable on the same interval (the quotient in (1) has no singularity since x>0).\n\n1.  Values of g at the endpoints.  \n    f(a)=f(b)=k \u21d2  \n\u2003\u2003g(a)= (f(a)-k)/a = 0,  \n\u2003\u2003g(b)= (f(b)-k)/b = 0.                                (2)\n\n2.  Rolle\u2019s theorem.  \n    Since g is continuous on [a,b], differentiable on (a,b) and g(a)=g(b), Rolle\u2019s theorem guarantees the existence of a point \u03be\u2208(a,b) with g\u2032(\u03be)=0.\n\n3.  Compute g\u2032.  \n\u2003For x>0,\n\u2003\u2003g(x)= (f(x)-k)/x \u21d2  \n\u2003\u2003g\u2032(x)= [x f\u2032(x) -(f(x)-k)] / x\u00b2 .               (3)\n\n4.  Condition at \u03be.  \n    g\u2032(\u03be)=0 gives, from (3),\n\n\u2003\u2003x f\u2032(x) -(f(x)-k) = 0 at x=\u03be,\n\n\u2003\u2003\u21d4\u2003f(\u03be) - \u03be f\u2032(\u03be) = k.                           (4)\n\nThus there exists \u03be\u2208(a,b) satisfying (4), which is precisely\n\n\u2003\u2003f(\u03be) - \u03be f\u2032(\u03be) = k.\n\nThis completes the proof.\n\nFinal answer.",
      "Let  \n\n\u2003\u2003\u03c6(x)=f(x)\u2212x f\u2032(x)\u2212k , \u2003\u2003x\u2208[a , b].\n\nBecause f is C\u00b9 on (0,\u221e), \u03c6 is continuous on [a,b].  \nWe have  \n\n\u2003\u2003\u03c6(a)=f(a)\u2212k\u2212a f\u2032(a)=\u2212a f\u2032(a),  \n\u2003\u2003\u03c6(b)=f(b)\u2212k\u2212b f\u2032(b)=\u2212b f\u2032(b).                                       (1)\n\nOur goal is to prove that \u03c6 vanishes at some point \u03be\u2208(a,b).\n\n--------------------------------------------------------------------------------\n1.  If \u03c6(a)=0 or \u03c6(b)=0 we are done, so suppose \u03c6(a)\u22600 and \u03c6(b)\u22600.\n\n2.  If \u03c6(a) and \u03c6(b) have opposite signs, continuity of \u03c6 gives a zero between a\n    and b; hence let us assume that they have the same sign.\n    By (1) this means that f\u2032(a) and f\u2032(b) have the same (non\u2013zero) sign.\n\n    Case A.  f\u2032(a)>0 and f\u2032(b)>0.  \n    Because f\u2032(a)>0, for x>a sufficiently close to a we have f(x)>f(a)=k, so\n    f attains a value strictly larger than k somewhere in (a,b).\n    Let x\u2080 be a point where f reaches its (global) maximum on [a,b].\n    Since f(a)=f(b)=k< f(x\u2080), the point x\u2080 lies in (a,b); consequently f\u2032(x\u2080)=0.\n    Hence\n\n        \u03c6(x\u2080)=f(x\u2080)\u2212k\u2212x\u2080 f\u2032(x\u2080)=f(x\u2080)\u2212k>0.\n\n    On the other hand \u03c6(a)=\u2212a f\u2032(a)<0, so \u03c6(a)<0<\u03c6(x\u2080); by the Intermediate\n    Value Theorem there exists \u03be\u2208(a,x\u2080)\u2282(a,b) with \u03c6(\u03be)=0.\n\n    Case B.  f\u2032(a)<0 and f\u2032(b)<0.  \n    Now f\u2032(a)<0 implies that for x>a near a we have f(x)<k, so f takes values\n    strictly smaller than k.  Let y\u2080 be a point where f attains its minimum on\n    [a,b].  Then y\u2080\u2208(a,b) and f\u2032(y\u2080)=0, whence\n\n        \u03c6(y\u2080)=f(y\u2080)\u2212k\u2212y\u2080 f\u2032(y\u2080)=f(y\u2080)\u2212k<0,\n\n    while \u03c6(a)=\u2212a f\u2032(a)>0.  Again, continuity of \u03c6 furnishes a point\n    \u03be\u2208(a,y\u2080) with \u03c6(\u03be)=0.\n\n3.  If f is identically equal to k on [a,b] (i.e. f\u2261k), then f\u2032\u22610 and\n    \u03c6(x)=0 for every x, so any \u03be\u2208(a,b) works.\n\n--------------------------------------------------------------------------------\nIn every possible situation we have produced \u03be\u2208(a,b) such that \u03c6(\u03be)=0, that is,\n\n\u2003\u2003f(\u03be)\u2212\u03be f\u2032(\u03be)=k.\n\nHence the desired point \u03be exists.\n\nFinal answer: there exists a point \u03be\u2208(a,b) satisfying f(\u03be)\u2212\u03be f\u2032(\u03be)=k.",
      "Let  \n\n\u2003g(x)= (f(x)-k)/x ,\u2003x\u2208[a , b]\u2003\u2003\u2003( a>0,\u2006 b>a ).\n\n1.  Regularity  \n   \u2022 f is C\u00b9 on (0,\u221e), hence continuous on [a,b] and differentiable on (a,b).  \n   \u2022 Because x\u21a61/x is C\u00b9 on (0,\u221e), g is continuous on [a,b] and differentiable on (a,b).\n\n2.  Values at the endpoints  \n   f(a)=f(b)=k \u21d2  \n\u2003g(a)= (k\u2212k)/a =0,\u2003g(b)= (k\u2212k)/b =0.\n\n3.  Apply Rolle\u2019s theorem  \n   Since g is continuous on [a,b], differentiable on (a,b), and g(a)=g(b), there exists \u03be\u2208(a,b) with g\u2032(\u03be)=0.\n\n4.  Compute g\u2032  \n   g\u2032(x)= [x f\u2032(x) \u2212 (f(x)\u2212k)] / x\u00b2.\n\n   Setting x=\u03be and using g\u2032(\u03be)=0 gives  \n\u2003x f\u2032(x) \u2212 (f(x)\u2212k)=0 \u21d2 f(\u03be) \u2212 \u03be f\u2032(\u03be)=k.\n\nThus a point \u03be in (a,b) satisfying the desired relation exists.\n\nFinal answer: There exists \u03be\u2208(a,b) such that\u2003f(\u03be)\u2212\u03be f\u2032(\u03be)=k."
    ],
    "variant_times": [
      28.461215257644653,
      81.52507019042969,
      34.17113399505615
    ],
    "final": "Let  \n\n\u2003g(x)=\\dfrac{f(x)-k}{x},\\qquad x\\in[a,b]\\;(0<a<b).  \n\nProperties of g  \n\u2022  f is C\u00b9 on (0,\u221e), hence continuous on [a,b] and differentiable on (a,b).  \n\u2022  x\u21a61/x is C\u00b9 on (0,\u221e), so g is continuous on [a,b] and differentiable on (a,b).\n\nEndpoint values  \nBecause f(a)=f(b)=k,  \n\u2003g(a)=\\dfrac{k-k}{a}=0,\\qquad g(b)=\\dfrac{k-k}{b}=0.\n\nRolle\u2019s theorem  \ng is continuous on [a,b], differentiable on (a,b), and g(a)=g(b); therefore there exists \u03be\u2208(a,b) with g\u2032(\u03be)=0.\n\nDerivative of g  \nFor x>0,\n\n\u2003g\u2032(x)=\\frac{x f'(x)\\;-\\;(f(x)-k)}{x^{2}}.\n\nAt x=\u03be we have g\u2032(\u03be)=0, hence\n\n\u2003x f'(x)-(f(x)-k)=0\\;\\Longrightarrow\\;f(\u03be)-\u03be f'(\u03be)=k.\n\nThus there exists \u03be\u2208(a,b) such that  \n\n\u2003f(\u03be)-\u03be f'(\u03be)=k.\u2003\u220e\n\nFinal answer.",
    "final_time": 9.951730966567993,
    "total_problem_time": 154.1091504096985
  },
  {
    "id": "problem_7",
    "round": "Day 2",
    "variants": [
      "Denote by \u2115 the set of positive integers.  \nWe have to describe every non\u2013empty set  \n\n\u2003\u2003M \u2282 \u2115                                (1)\n\nwhich fulfils  \n\n\u2003(a)\u2003x \u2208 M\u2003\u21d2\u20032x \u2208 M;  \n\n\u2003(b)\u2003x, y \u2208 M,\u2003x \u2261 y (mod 2)\u2003\u21d2\u2003(x+y)/2 \u2208 M.                           (2)\n\n\n-------------------------------------------------------------------------------\n1.  An obvious family of examples\n-------------------------------------------------------------------------------\nLet d be any positive odd number and put  \n\n\u2003\u2003M_d := { d, 2d, 3d, \u2026 } = d \u2115.                                       (3)\n\n(3) fulfils (a) because 2\u00b7kd = (2k)d, and it fulfils (b) because if\nkd, \u2113d \u2208 M_d have the same parity then k+\u2113 is even (d is odd), hence\n\n\u2003\u2003(kd+\u2113d)/2 = d(k+\u2113)/2 \u2208 d \u2115 = M_d.\n\nConsequently every set M_d with odd d obeys (1), (2).\n\nWe prove that no other non\u2013empty set can satisfy (2).\n\n-------------------------------------------------------------------------------\n2.  The gcd of M must be odd\n-------------------------------------------------------------------------------\nWrite  \n\n\u2003\u2003g := gcd M.\n\nIf g were even, choose any element x \u2208 M (hence x+g \u2208 M as well, by (a) and\nrepeated doubling).  The numbers x and x+g are both even, so (b) would force\n\n\u2003\u2003(x+(x+g))/2 = x+g/2                                             (4)\n\nto lie in M.  But g/2 is not an integer, contradiction.  Hence g is odd.     (5)\n\n-------------------------------------------------------------------------------\n3.  It suffices to study the set M / g\n-------------------------------------------------------------------------------\nPut  \n\n\u2003\u2003S := { x/g ; x \u2208 M } \u2282 \u2115.\n\nBecause g is odd, division by g preserves parity; therefore S again satisfies\n(a) and (b).  Moreover  \n\n\u2003\u2003gcd S = 1.                                                        (6)\n\nIf we succeed in proving\n\n\u2003\u2003S = \u2115,                                                           (7)\n\nthen multiplying every integer by g shows\n\n\u2003\u2003M = g \u2115,                                                         (8)\n\nand, because g is odd, (8) is exactly one of the sets (3).  Thus it only\nremains to establish (7).\n\n-------------------------------------------------------------------------------\n4.  A subset of \u2115 which fulfils (a), (b) and has gcd 1 is the whole \u2115\n-------------------------------------------------------------------------------\nLet S\u2282\u2115 be non\u2013empty, satisfy (a) and (b) and have gcd 1.\nWrite m:=min S.\n\nStep 1.  m=1.  \nBecause gcd S=1 there exists n \u2208 S which is not divisible by m.  \nReplacing n by 2n if necessary we may suppose n and m have the same parity\n (this uses (a)).  \nNow both numbers lie in S and have the same parity, so (b) yields  \n\n\u2003\u2003r := (m+n)/2 \u2208 S.                                                (9)\n\nBut 0<r<m (because n is not a multiple of m), contradicting the minimality\nof m unless m=1.\n\nStep 2.  S contains every positive integer.  \nWe prove by strong induction on k.\n\nBase k=1: 1\u2208S by step 1.\n\nInduction step. Assume 1,2,\u2026,k\u2208S; we show k+1\u2208S.\n\n\u2022 If k+1 is even, write k+1=2t with t\u2264k.  By the induction hypothesis\nt\u2208S; property (a) then gives 2t=k+1\u2208S.\n\n\u2022 If k+1 is odd, then k and k+2 are both even.  The induction hypothesis\ngives k, k+2\u2208S; they have the same parity, so (k+(k+2))/2=k+1 belongs to S\nby (b).\n\nThus k+1\u2208S in either case, completing the induction and proving (7).\n\n-------------------------------------------------------------------------------\n5.  Conclusion\n-------------------------------------------------------------------------------\nFrom sections 2\u20134 we have proved that every non\u2013empty set M obeying (a),(b)\nis of the form g \u2115 with g odd; and section 1 showed that such sets indeed\nsatisfy (a),(b).\n\nTherefore the complete list of solutions is\n\n\u2003\u2003M = d \u2115 := { d, 2d, 3d, \u2026 }\u2003for an arbitrary odd positive integer d.\n\n-------------------------------------------------------------------------------\nFinal answer\n-------------------------------------------------------------------------------\nAll required subsets are the sets of all positive multiples of a fixed odd\ninteger:\n\n\u2003\u2003Final answer.\u2003M = {\u2009d, 2d, 3d, \u2026\u2009} with d an odd positive integer.",
      "Let M\u2282\u2124>0 be non\u2013empty and satisfy  \n\n(a)  x\u2208M \u21d2 2x\u2208M,  \n\n(b)  if x,y\u2208M and x+y is even, then (x+y)/2\u2208M.\n\nDenote  \nO := M\u2229(odd integers),\u2003E := M\u2229(even integers).\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014  \n1.  If O=\u2205 (M contains no odd number)\n\nTake the least element of M and call it e0 .  \nBecause of (a) we have 2e0 ,4e0 ,\u2026 \u2208M; hence e0 is even.  \nNow let e\u2265e0 be any even number.  Write e = e0 + 2k (k\u22650).\nUsing k times the pair (e0 ,e0 +2) we can bring e into M by repeated\napplication of (b):\ne0 , e0 +2 \u21d2 e0 +1 (odd, not required) and e0 +2 are in M,\ne0 +2 , e0 +4 \u21d2 e0 +3 (odd) and e0 +4 in M,\n\u2026\nso every even number \u2265e0 is forced to be in M,\nwhile no odd number can enter because the hypothesis forbids it.\nThus in this case  \n\n\u2003\u2003M = { n\u2208\u2124>0 : n is even and n \u2265 e0 }             (1)\n\nwith an arbitrary even e0 \u22652.\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014  \n2.  If O\u2260\u2205 (M contains at least one odd number)\n\nLet o0 be the smallest odd element of M and let e0 be the smallest even\nelement of M (existence of e0 is guaranteed by (a) because 2o0\u2208M).\n\n(i)  e0 equals o0 \u20131 or o0 +1  \nIndeed, o0 and o0 +2 have the same parity; if o0 +2\u2208M then by (b)\n(o0 +(o0 +2))/2 = o0 +1\u2208M, so e0 \u2264 o0 +1.\nIf o0 +2\u2209M,  consider 2o0 and 4o0 which are in M by (a);\ntheir midpoint 3o0 is odd and in M, and repeating the procedure\nsoon produces two consecutive odd numbers, forcing the even\ninteger between them into M.  Consequently e0 \u2265 o0 \u20131.\nBecause e0 is even, we must have e0 = o0 \u20131 or e0 = o0 +1.\n\n(ii)  M contains every integer \u2265min{e0 ,o0 }.  \nPut c := min{e0 ,o0 }.  Suppose, to the contrary, that some m\u2265c is not\nin M and let m be the smallest such number.\n\n\u2022  If m is even, then m\u20131 and m+1 are consecutive odd numbers \u2265o0 ;\nboth are in M, so their midpoint m must lie in M, contradiction.\n\n\u2022  If m is odd, then m\u20131 and m+1 are consecutive even numbers \u2265e0 ;\nboth are in M, so (m\u20131+m+1)/2 = m is in M, contradiction.\n\nThus every integer \u2265c lies in M.  Because e0 is either c or c+1,\nthe set obtained is simply\n\n\u2003\u2003M = { n\u2208\u2124>0 : n \u2265 c }                            (2)\n\nwith an arbitrary integer c\u22651.\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014  \n3.  Completeness\n\nSets of the two kinds (1) and (2) obviously satisfy (a) and (b), so no\nfurther sets occur.\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014  \nHence all non-empty subsets M\u2282\u2124>0 fulfilling (a) and (b) are exactly\n\n1.  the even tails\u2003\u2003{ 2k, 2k+2, 2k+4, \u2026 } \u2003(k=1,2,3,\u2026);\n\n2.  the full tails\u2003\u2003{ k, k+1, k+2, \u2026 }\u2003\u2003\u2003\u2003(k=1,2,3,\u2026).\n\nNo other subsets have the required two closure properties.\n\nFinal answer.",
      "Let \\(M\\subseteq\\mathbb Z_{>0}\\) be non-empty and satisfy  \n\n(a)  \\(x\\in M\\Longrightarrow 2x\\in M\\);  \n\n(b)  if \\(x,y\\in M\\) and \\(x+y\\) is even, then \\(\\dfrac{x+y}{2}\\in M\\).\n\nDenote  \n\n\\[\nd=\\gcd\\{\\,m\\mid m\\in M\\}.\n\\]\n\nSTEP 1.  \\(d\\) is odd.  \nIf every element of \\(M\\) were even, pick any \\(m\\in M\\).  \nBecause of (a), \\(2m\\in M\\) and both \\(m,2m\\) are even, so by (b)\n\\[\n\\frac{m+2m}{2}= \\frac{3m}{2}\\in M .\n\\]\nBut \\(\\dfrac{3m}{2}\\) is odd \u2013 contradiction.  \nHence \\(M\\) contains an odd element, so its greatest common divisor \\(d\\) is odd.\n\nSTEP 2.  Every element of \\(M\\) is a multiple of \\(d\\).  \nThis is immediate from the definition of \\(d=\\gcd M\\).\n\nSTEP 3.  All positive multiples of \\(d\\) lie in \\(M\\).\n\nWe prove by induction on a positive integer \\(k\\) that \\(kd\\in M\\).\n\nBase \\(k=1\\): \\(d\\in M\\) by definition.\n\nInductive step.  \nAssume \\(kd\\in M\\).\n\n(i)  If \\(k\\) is even, write \\(k=2r\\).  Then \\(rd\\in M\\) by the induction hypothesis,\nand property (a) gives \\(kd=2(rd)\\in M\\).\n\n(ii)  If \\(k\\) is odd (\\(k\\ge 3\\)), write \\(k=2r+1\\) (\\(r\\ge 1\\)).\nBy the induction hypothesis the even multiples\n\\(2rd\\) and \\(2(r+1)d\\) are in \\(M\\); they have the same\nparity, so property (b) gives\n\\[\n\\frac{2rd+2(r+1)d}{2}=d(2r+1)=kd\\in M.\n\\]\n\nThus \\(kd\\in M\\) for every \\(k\\in\\mathbb Z_{>0}\\); i.e.\n\n\\[\n\\{kd\\mid k\\in\\mathbb Z_{>0}\\}\\subseteq M .\n\\]\n\nSTEP 4.  No further elements can belong to \\(M\\).  \nBecause every member of \\(M\\) is a multiple of \\(d\\) (Step 2), we have the opposite inclusion\n\\(M\\subseteq\\{kd\\mid k\\in\\mathbb Z_{>0}\\}\\).\n\nConsequently  \n\n\\[\nM=\\{kd\\mid k\\in\\mathbb Z_{>0}\\},\n\\]\nwhere \\(d\\) is an odd positive integer.\n\nSTEP 5.  Verification.  \nFor an odd \\(d\\) set \\(M_d=\\{kd\\mid k\\ge 1\\}\\).\n\n\u2022 Property (a) is obvious.  \n\u2022 For property (b), let \\(x=kd,\\;y=\\ell d\\) with \\(k,\\ell\\in\\mathbb Z_{>0}\\).  \nIf \\(x+y\\) is even, then \\(k+\\ell\\) is even (because \\(d\\) is odd), so \\(\\dfrac{k+\\ell}{2}\\) is an integer and\n\\[\n\\dfrac{x+y}{2}=d\\cdot\\dfrac{k+\\ell}{2}\\in M_d.\n\\]\n\nHence \\(M_d\\) satisfies (a) and (b).\n\nConclusion.  \nThe required subsets are precisely the sets of all positive multiples of an odd integer.\n\nFinal answer.\nEvery such subset is\n\\[\nM_d=\\{\\,kd\\mid k\\in\\mathbb Z_{>0}\\},\n\\]\nwhere \\(d\\) is an arbitrary odd positive integer; and these sets all satisfy the given conditions."
    ],
    "variant_times": [
      310.5708417892456,
      223.025573015213,
      240.4115288257599
    ],
    "final": "Solution.\n\nLet M be a non-empty subset of the positive integers which satisfies  \n\n(a)\u2003x \u2208 M\u2003\u21d2\u20032x \u2208 M,  \n\n(b)\u2003x,y \u2208 M and x+y even\u2003\u21d2\u2003(x+y)/2 \u2208 M.\n\nPut m := min M.\n\n--------------------------------------------------------------------\n1.  When every element of M is divisible by m\n--------------------------------------------------------------------\nSuppose first that every member of M is a multiple of m.\nTake 2 and 4 multiples of m:  x := m,  y := 2m;  both lie in M and are\neven, so (b) gives (x+y)/2 = (3m)/2 \u2208 M.\nConsequently 3m/2 must be an integer; hence m is odd.  \nProperty (a) then shows that all positive multiples of m belong to M, and\nno other integer can: otherwise the average of it with the nearest\nmultiple of m would fail to be a multiple of m, contradicting (b).\nThus\n\n\u2003\u2003M = { m,2m,3m,\u2026 }\u2003with m odd.                        (1)\n\n--------------------------------------------------------------------\n2.  When M contains a number not divisible by m\n--------------------------------------------------------------------\nAssume now that M contains some t that is not a multiple of m.\nWe prove by induction that every integer \u2265 m is in M.\n\nInduction basis\u2003Numbers m and m+1.\nIf m itself is odd (hence so is t after, if necessary, doubling it once),\nthen m and t have the same parity.  Write t = qm+r with 1\u2264r\u2264m\u20131.  \nBecause m\u2264t we have q\u22651, so qm and qm+2m (= (q+2)m) lie in M by (a).\nBoth are even; their average (b) is (q+1)m, whose average with m is\nm+((q+1)m\u2013m)/2=m+q(m)/2\u2265m+1.  Repeating this averaging if necessary\ndecreases the distance to m by 1 each time, so eventually m+1\u2208M.\n\nIf m is even, then 2m and t have the same parity (both even after one\ndoubling of t if needed).  The preceding paragraph applied to 2m instead\nof m again yields m+1 \u2208 M.\n\nInduction step\u2003Assume every integer from m up through k (k\u2265m) lies in M.\nTo prove k+1 \u2208 M we distinguish parities.\n\n\u2022 k+1 even:  s := (k+1)/2 lies between m and k, hence\ns\u2208 M and 2s = k+1 \u2208 M by (a).\n\n\u2022 k+1 odd:  k and k+2 are even and both belong to M, so their\naverage is k+1, which therefore lies in M by (b).\n\nThus, by induction,\n\n\u2003\u2003M = { m,m+1,m+2,\u2026 }.                                (2)\n\n--------------------------------------------------------------------\n3.  Completeness of the list\n--------------------------------------------------------------------\nSets of the two kinds (1) and (2) plainly satisfy (a) and (b); parts 1 and 2\nshow that no other set can.\n\n--------------------------------------------------------------------\nAnswer\n--------------------------------------------------------------------\nExactly two types of non-empty subsets of \u2124_{>0} satisfy (a) and (b):\n\n1.  the set of all positive multiples of an odd integer d  \n\u2003\u2003M = { d,2d,3d,\u2026 }\u2003(d odd);\n\n2.  a \u201ctail\u2019\u2019 beginning with some positive integer c  \n\u2003\u2003M = { c,c+1,c+2,\u2026 }\u2003(c\u22651).\n\nFinal answer.",
    "final_time": 524.4701261520386,
    "total_problem_time": 1298.478069782257
  },
  {
    "id": "problem_8",
    "round": "Day 2",
    "variants": [
      "Solution outline:\n\n1.  Put the symmetry \\(A=A^{R}\\) into an algebraic form.  \n    Denote by\n    \\[\n      J=\\begin{bmatrix}\n             0 &        & 1\\\\\n               & \\iddots &  \\\\\n             1 &        & 0\n          \\end{bmatrix}\\qquad(\\;J_{i,n-i+1}=1,\\;J^{2}=I_{n},\\;J^{\\mathsf T}=J\\;).\n    \\]\n    A direct calculation of the entry \\((i,j)\\) shows\n    \\[\n       A^{R}=J\\,A^{\\mathsf T}.\n    \\]\n    Hence the hypothesis \\(A=A^{R}\\) is equivalent to\n    \\[\n       A=J\\,A^{\\mathsf T}\\qquad\\Longleftrightarrow\\qquad\n       J\\,A \\text{ is symmetric},\n       \\tag{1}\n    \\]\n    or, written differently,\n    \\[\n       A^{\\mathsf T}J=J\\,A. \\tag{2}\n    \\]\n\n2.  Introduce the (real, symmetric, non\u2013degenerate) bilinear form\n    \\[\n        [x,y]=x^{\\mathsf T}Jy\\qquad(x,y\\in\\mathbb R^{\\,n}).\n    \\]\n    Because of (2) we have\n    \\[\n       [Ax,y]=x^{\\mathsf T}A^{\\mathsf T}Jy\n             =x^{\\mathsf T}J\\,Ay\n             =[x,Ay],\\qquad\\forall\\,x,y,\n    \\]\n    i.e. **\\(A\\) is self\u2010adjoint with respect to the form \\([\\,,]\\).**\n\n3.  Consequence for a (complex) eigenpair.  \n    Let \\(\\lambda\\in\\mathbb C\\) be an eigenvalue and \\(v\\neq0\\) a (complex)\n    eigenvector: \\(Av=\\lambda v\\).\n    Then, exploiting self\u2013adjointness,\n    \\[\n       \\lambda\\,[v,v]=[Av,v]=[v,Av]=\\bar\\lambda\\,[v,v].\n    \\]\n    Thus\n    \\[\n       (\\lambda-\\bar\\lambda)\\,[v,v]=2i\\,\\Im\\lambda\\,[v,v]=0.\n    \\]\n    Therefore\n\n        \u2022 Either \\(\\Im\\lambda=0\\) and \\(\\lambda\\) is **real**,  \n        \u2022 or \\([v,v]=0\\).\n\n4.  Treat the second possibility.  \n    Suppose \\(\\Im\\lambda\\neq0\\); then \\([v,v]=0\\).\n    Write \\(v=x+iy\\) with real vectors \\(x,y\\).  \n    From \\([v,v]=0\\) we get\n    \\[\n        x^{\\mathsf T}Jx=y^{\\mathsf T}Jy,\\qquad\n        x^{\\mathsf T}Jy=0.\\tag{3}\n    \\]\n    The real sub-space \\(V=\\operatorname{span}\\{x,y\\}\\) is \\(A\\)-invariant and,\n    in the basis \\(\\{x,y\\}\\), the matrix of \\(A_{|V}\\) equals\n    \\[\n       M=\\begin{bmatrix}a&-b\\\\ b&a\\end{bmatrix},\n       \\quad\\hbox{where }\\lambda=a+ib\\;(b\\ne0).\\tag{4}\n    \\]\n    The restriction of the form \\([\\,,]\\) to \\(V\\) has Gram matrix\n    \\[\n         G=\\begin{bmatrix}g&0\\\\0&g\\end{bmatrix},\\qquad\n         g:=x^{\\mathsf T}Jx=y^{\\mathsf T}Jy.\n    \\]\n    If \\(g\\neq0\\) then \\(G\\) is a non\u2013singular scalar multiple of the identity\n    and the self\u2013adjointness condition \\(G\\,M=M^{\\mathsf T}G\\) forces\n    \\(M=M^{\\mathsf T}\\), hence \\(b=0\\)\u2014contradicting \\(b\\ne0\\).\n\n    Thus \\(g=0\\).  \n    Taking \\(z:=x+Jx\\) we have\n    \\(\n        z^{\\mathsf T}Jz\n        =x^{\\mathsf T}Jx + x^{\\mathsf T}J^{2}x\n        =2x^{\\mathsf T}x>0,\n    \\)\n    so the form is **non\u2013degenerate on \\(V'=\\operatorname{span}\\{x,z\\}\\)**\n    (still \\(A\\)-invariant).\n    On \\(V'\\) the matrix of \\(A\\) is again of the shape (4)\n    and the same argument as above enforces \\(b=0\\).\n\n    Hence the alternative \\(\\Im\\lambda\\neq0\\) is impossible unless\n    \\(a=0\\); i.e. \\(\\lambda\\) is **purely imaginary**.\n\n5.  Conclusion.  \n    Every eigenvalue of a real matrix \\(A\\) satisfying \\(A=A^{R}\\)\n    is either real or purely imaginary:\n\n       \u2003\u2003\\(\\displaystyle \\Re\\lambda=0\\quad\\text{or}\\quad\\Im\\lambda=0.\\)\n\nFinal answer.",
      "Let  \n\nQ = (q_{ij})_{1\\le i,j\\le n}, \u2003q_{ij}=\u03b4_{\\,i,n+1-j}  \n\n(the \u201creverse\u2013identity\u2019\u2019 matrix that writes the coordinates in the opposite order).  \nQ is real, orthogonal and symmetric:\n\n\u2003Q = Q^{T},\u2003Q^{2}=I.  \n\n-------------------------------------------------------------------------------\n1.  A 90\u00b0\u2013rotation equals  Q A^{T}\n\nFor every matrix A=(a_{ij}) put  \n\n(RA)_{ij}=a_{j,\\,n+1-i}.  \n\nBecause q_{i,n+1-k}=\u03b4_{ik},  \n\n(QA^{T})_{ij}=\u2211_{k}q_{ik}a_{jk}=a_{j,\\,n+1-i}=(A^{R})_{ij}.  \n\nHence\n\n\u2003A^{R}=Q\\,A^{T}.\u2003\u2003(1)\n\n-------------------------------------------------------------------------------\n2.  The hypothesis A=A^{R} gives a factorisation A=QS with S symmetric  \n\nFrom (1)\n\n\u2003A=Q\\,A^{T}\u2003\u21d4\u2003Q A=A^{T}.                         (2)\n\nPut S:=Q A.  \nTaking the transpose of (2) gives S^{T}=Q A=A=S, so\n\n\u2003S=S^{T}.                                         (3)\n\nTherefore\n\n\u2003A=Q A =Q^{2}A =Q S\u2003\u2003with\u2003S^{T}=S.               (4)\n\nSo A is the product \u201corthogonal\u2009\u00d7\u2009symmetric\u2019\u2019 of the symmetric orthogonal\nmatrix Q and the symmetric matrix S.\n\n-------------------------------------------------------------------------------\n3.  An eigen-equation for S\n\nLet \u03bb\u2208\u2102 and 0\u2260x\u2208\u2102^{n} satisfy A x = \u03bb x.  \nPremultiplying by Q and using (4) we obtain\n\n\u2003S x = \u03bb Q x.                                     (5)\n\n-------------------------------------------------------------------------------\n4.  Squaring (5) yields a real number\n\nBecause S is symmetric,\n\n\u2003x^{T}S^{2}x\u2003\u2003is a real (in fact non\u2013negative) scalar.     (6)\n\nTaking the inner product of (5) with itself gives\n\n\u2003x^{T}S^{2}x = \u03bb^{2} x^{T}x.                      (7)\n\nSince x^{T}x > 0, division by x^{T}x gives\n\n\u2003\u03bb^{2} =               x^{T}S^{2}x\n             \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014   \u2208 \u211d.             (8)\n                       x^{T}x\n\nThus \u03bb^{2} is a real number.\n\n-------------------------------------------------------------------------------\n5.  Consequence for \u03bb\n\nWrite \u03bb = a + ib (a,b\u2208\u211d).  Then\n\n\u2003\u03bb^{2} = (a^{2}-b^{2}) + 2abi  \u2208 \u211d\n\u2003\u2003\u2003\u2003\u2003\u21d4\u20032ab = 0\n\u2003\u2003\u2003\u2003\u2003\u21d4\u2003a=0  or  b=0.\n\nTherefore every eigenvalue of A is either purely real (b=0) or purely imaginary\n(a=0).\n\n-------------------------------------------------------------------------------\nFinal answer\nIf a real matrix A satisfies A=A^{R}, then every eigenvalue \u03bb of A obeys\nRe\u2009\u03bb = 0 or Im\u2009\u03bb = 0;  i.e. \u03bb is purely real or purely imaginary.",
      "Let  \n\n\u2003J = (Jij )1\u2264 i ,j \u2264 n ,\u2003\u2003Jij = {1  if  j = n+1\u2013i, 0 otherwise}\n\n(the \u201cback-diagonal\u2019\u2019 permutation matrix).  \nJ is real, symmetric, and involutory:\u2003J = J \u1d40,\u2003J\u00b2 = I.\n\n1. 90\u00b0\u2013rotation is J\u00b7transpose  \n\n   For every A = (aij ),\n\n        (A^R)ij = a j , n+1\u2013i = (J A\u1d40)ij .                         (1)\n\n   Hence A = A^R \u2003\u21d4\u2003 A = J A\u1d40 .                                   (2)\n\n2. Consequences of (2)\n\n   Taking the transpose of (2):\n\n        A\u1d40 = (J A\u1d40)\u1d40 = A J.                                       (3)\n\n   Multiplying (2) on the right by J and using (3) gives\n\n        A J = J A.                                                (4)\n\n   Thus A commutes with J and is J-self-adjoint (A = J A\u1d40).\n\n3. Put J into normal form    \n\n   There is an orthogonal real matrix U such that\n\n        U\u1d40 J U = diag(Ip , \u2013Iq) \u2003(p+q = n).                       (5)\n\n   Re-write A in this basis:  B = U\u1d40 A U.  \n   With J in the form (5) the relations (2) and (4) become\n\n        B = J\u2080 B\u1d40 ,\u2003\u2003B J\u2080 = J\u2080 B,\u2003\u2003J\u2080 = diag(Ip , \u2013Iq).\n\n   Writing B in 2\u00d72 block form\n\n        B = [ P\u2003Q\n              R\u2003S ] ,\u2003P, S real square,\n\n   the two equalities above force\n\n        P = P\u1d40 ,\u2003S = \u2013S\u1d40  (hence S = 0),\u2003R = Q\u1d40 ,\u2003Q = \u2013Q\u1d40 .      (6)\n\n   So after an orthogonal similarity we may assume\n\n        A = [ P\u2003Q\n              \u2013Q\u20030 ],                                             (7)\n\n   where P is symmetric (size p\u00d7p) and Q is skew-symmetric (p\u00d7q).\n\n4. The eigen\u2013equations  \n\n   Let \u03bb be an eigenvalue of A and write an eigenvector in block form\n\n        x = [ u\n              v ] \u2003(u \u2208 \u211d\u1d56 , v \u2208 \u211d\u1d60 ,  (u,v) \u2260 0).\n\n   From (7)\n\n        P u + Q v = \u03bb u,\u2003\u2003\u2013Q u = \u03bb v.                            (8)\n\n   For \u03bb \u2260 0 the second line gives  v = \u2013\u03bb\u207b\u00b9 Q u,   \n   and substituting this into the first,\n\n        \u03bb P u \u2013 Q\u00b2 u = \u03bb\u00b2 u.                                      (9)\n\n5. A scalar relation  \n\n   Take the ordinary dot product of (9) with u (\u2016u\u2016\u00b2 = u\u1d40u):\n\n        \u03bb u\u1d40 P u \u2013 u\u1d40 Q\u00b2 u = \u03bb\u00b2 \u2016u\u2016\u00b2.                            (10)\n\n   Note that  \n        \u2013Q\u00b2 is positive\u2013semidefinite, hence u\u1d40 Q\u00b2 u \u2264 0,  \n        u\u1d40 P u is real (P symmetric).\n\n   Write \u03bb = \u03b1 + i\u03b2 (\u03b1,\u03b2 \u2208 \u211d).  Separating real and imaginary parts\n   in (10) gives\n\n        Imag:\u2003\u03b2(2\u03b1\u2016u\u2016\u00b2 \u2013 u\u1d40P u) = 0,                            (11)\n        Real:\u2003\u03b1 u\u1d40P u \u2013 u\u1d40Q\u00b2 u = (\u03b1\u00b2 \u2013 \u03b2\u00b2)\u2016u\u2016\u00b2.                 (12)\n\n6. If \u03b2 \u2260 0 (\u03bb not real)  \n\n   From (11):\u2002u\u1d40 P u = 2\u03b1\u2016u\u2016\u00b2.  Insert this in (12):\n\n        (\u03b1\u00b2 \u2013 \u03b2\u00b2)\u2016u\u2016\u00b2 = 2\u03b1\u00b2\u2016u\u2016\u00b2 \u2013 u\u1d40 Q\u00b2 u\n                         = 2\u03b1\u00b2\u2016u\u2016\u00b2 + |Q u|\u00b2   (because u\u1d40Q\u00b2u = \u2013|Qu|\u00b2).\n\n   Rearranging,\n\n        |\u03bb|\u00b2 \u2016u\u2016\u00b2 = \u03b1\u00b2 + \u03b2\u00b2 = \u2013u\u1d40Q\u00b2u / \u2016u\u2016\u00b2 \u2264 0.                 (13)\n\n   The left side is non\u2013negative, the right side non\u2013positive; hence both are\n   zero.  Since \u2016u\u2016 \u2260 0, (13) forces |\u03bb| = 0, i.e. \u03bb = 0 \u2014 contradicting \u03b2 \u2260 0.  \n   Therefore \u03b2 must be zero whenever \u03b1 \u2260 0.  So a non-real eigenvalue can only be purely imaginary.\n\n7. Conclusion  \n\n   Every eigenvalue \u03bb of A satisfies \u03b2 = 0 (\u03bb real) or \u03b1 = 0 (\u03bb purely imaginary).  Equivalently,\n\n        Re \u03bb = 0 \u2003or\u2003 Im \u03bb = 0.\n\nHence a matrix which equals its 90\u00b0 counter-clockwise rotation can have only real or purely imaginary eigenvalues.\n\nFinal answer."
    ],
    "variant_times": [
      268.7202398777008,
      231.2135169506073,
      258.83405089378357
    ],
    "final": "Let  \n\n\u2003J=\\begin{bmatrix}\n0 &        & 1\\\\\n  &\\iddots &  \\\\\n1 &        & 0\n\\end{bmatrix}\\qquad(J^{T}=J,\\;J^{2}=I_{n})\n\nbe the \u201cback\u2013diagonal\u2019\u2019 permutation matrix.  \nFor every real \\(n\\times n\\) matrix \\(A=(a_{ij})\\) one checks directly that  \n\n\\[\nA^{R}=J\\,A^{T}. \\tag{1}\n\\]\n\n--------------------------------------------------------------------\n1.  From the hypothesis\n\nIf \\(A=A^{R}\\), then (1) gives  \n\n\\[\nA=J\\,A^{T}\\;\\Longleftrightarrow\\;J\\,A=A^{T}. \\tag{2}\n\\]\n\nPut  \n\n\\[\nS:=J\\,A\\quad(\\text{so }A=J\\,S).\n\\]\n\nTaking the transpose in (2) yields \\(S^{T}=S\\); hence \\(S\\) is real-symmetric.  \nBecause \\(J^{2}=I\\), we also have\n\n\\[\nA=J\\,S=J^{2}A=S\\,J. \\tag{3}\n\\]\n\n--------------------------------------------------------------------\n2.  An eigen\u2013relation that involves only \\(S\\)\n\nLet \\(\\lambda\\in\\mathbb C\\) be an eigenvalue of \\(A\\) with eigenvector\n\\(0\\neq x\\in\\mathbb C^{n}\\):\n\n\\[\nA\\,x=\\lambda x.\n\\]\n\nMultiply by \\(J\\) and use \\(A=J\\,S\\) from (3):\n\n\\[\nS\\,x=\\lambda\\,Jx. \\tag{4}\n\\]\n\n--------------------------------------------------------------------\n3.  Squaring (4)\n\nApply (4) once more and remember that \\(J^{2}=I\\):\n\n\\[\nS^{2}x=\\lambda^{2}x. \\tag{5}\n\\]\n\n--------------------------------------------------------------------\n4.  Take the real scalar product\n\nBecause \\(S\\) is real-symmetric, \\(x^{\\!*}S^{2}x\\in\\mathbb R\\).  \nTaking the usual Hermitian inner product of (5) with \\(x\\) gives\n\n\\[\nx^{\\!*}S^{2}x=\\lambda^{2}\\,x^{\\!*}x. \\tag{6}\n\\]\n\nSince \\(x^{\\!*}x>0\\), division by this positive real number yields\n\n\\[\n\\lambda^{2}\\in\\mathbb R. \\tag{7}\n\\]\n\n--------------------------------------------------------------------\n5.  Consequences for \\(\\lambda\\)\n\nWrite \\(\\lambda=a+ib\\;(a,b\\in\\mathbb R)\\).  \nThen \\(\\lambda^{2}=(a^{2}-b^{2})+2abi\\).  \nThe imaginary part of \\(\\lambda^{2}\\) is \\(2ab\\); by (7) it must be zero, so  \n\\(2ab=0\\).  Hence\n\n\u2003either\u2003\\(b=0\\)  (and \\(\\lambda=a\\in\\mathbb R)\\),  \n\u2003or\u2003\u2003  \\(a=0\\)  (and \\(\\lambda=ib\\) is purely imaginary).\n\n--------------------------------------------------------------------\n6.  Conclusion\n\nEvery eigenvalue \\(\\lambda\\) of a real matrix satisfying \\(A=A^{R}\\) is\neither real or purely imaginary; equivalently\n\n\\[\n\\boxed{\\;\\Re\\lambda=0\\quad\\text{or}\\quad\\Im\\lambda=0\\;}.\n\\]\n\n--------------------------------------------------------------------\nFinal answer.",
    "final_time": 25.756743907928467,
    "total_problem_time": 784.5245516300201
  },
  {
    "id": "problem_9",
    "round": "Day 2",
    "variants": [
      "Let  \n\n\u2003\u2003Y\u2099 = max{X\u2081 , \u2026 , X\u2099}, \u2003\u2003n \u2265 1 .  \n\nThroughout we shall repeatedly use  \n\n\u2003\u2003E [Z] = \u2211_{k \u2265 1} P(Z \u2265 k)                        (1)\n\nwhich is valid for every positive\u2013integer\u2013valued random variable Z.\n\n--------------------------------------------------------------------\n1.  The tail\u2013probability of Y\u2099\n--------------------------------------------------------------------\nFor an integer k we want P ( Y\u2099 < k ).  \nIf k \u2264 n this probability is 0, because k\u20131 different numbers cannot\ncontain n distinct elements.  \nHence we assume k \u2265 n + 1.\n\nAfter j selections ( j \u2264 n ) exactly j numbers have been removed.\nIn order that all already chosen numbers stay below k\nthe j-th choice has to be taken among the first k\u2013j\nnumbers that are still available.  \nThe rule of the process gives\n\n\u2003\u2003P( \u201cthe j-th choice has rank at most k\u2212j\u201d ) = \u2211_{i = 1}^{k-j} 2^{-i}\n                                             = 1 \u2212 2^{-(k-j)} .\n\nConsequently\n\n\u2003\u2003P ( Y\u2099 < k )\n        = \u220f_{j = 1}^{n} ( 1 \u2212 2^{-(k-j)} )\n        = \u220f_{i = k-n}^{k-1} ( 1 \u2212 2^{-i} ).            (2)\n\n(For k = n the factor with i = 0 is 1 \u2212 1 = 0, agreeing with the remark\nmade at the beginning.)\n\nFrom (2) we obtain\n\n\u2003\u2003P ( Y\u2099 \u2265 k )  =  1 ,\n\u2003\u2003\u2003\u2003k = 1 , \u2026 , n,                                (3a)\n\n\u2003\u2003P ( Y\u2099 \u2265 k )  =  1 \u2212 \u220f_{i = k-n}^{k-1} ( 1 \u2212 2^{-i} ) ,\n\u2003\u2003\u2003\u2003k \u2265 n+1 .                                     (3b)\n\n--------------------------------------------------------------------\n2.  Writing the expected value with the probabilities of (3)\n--------------------------------------------------------------------\nInsert (3) in (1):\n\nE[Y\u2099]\n   = n                                                         (from k = 1,\u2026,n)\n     + \u2211_{k = n+1}^{\u221e} ( 1 \u2212 \u220f_{i = k-n}^{k-1}(1 \u2212 2^{-i}) ).     (4)\n\nPut m = k \u2212 n (so k = m + n, m = 1,2,\u2026):\n\nE[Y\u2099] = n + S\u2099   with\n\nS\u2099 = \u2211_{m = 1}^{\u221e}  ( 1 \u2212 \u220f_{i = m}^{m+n-1} ( 1 \u2212 2^{-i} ) ).    (5)\n\n--------------------------------------------------------------------\n3.  Evaluation of S\u2099 by induction on n\n--------------------------------------------------------------------\nFor n = 1 we have\n\nS\u2081 = \u2211_{m \u2265 1} 2^{-m} = 1 = 1/(2\u00b9 \u2212 1).                    (6)\n\nAssume for some n \u2265 2 that\n\nS\u2099\u208b\u2081 = \u2211_{i=1}^{n-1} 1/(2^{i} \u2212 1).                        (7)\n\nWrite the bracket of (5) as\n\n1 \u2212 \u03a0_{i=m}^{m+n-1}(1\u22122^{-i})\n  = [1 \u2212 \u03a0_{i=m}^{m+n-2}(1\u22122^{-i})]                        (8)\n    + 2^{-(m+n-1)} \u03a0_{i=m}^{m+n-2}(1\u22122^{-i}).\n\nSumming (8) over m \u2265 1 gives\n\nS\u2099 = S\u2099\u208b\u2081  +  T\u2099 ,                                         (9)\n\nwhere\n\nT\u2099 = \u2211_{m=1}^{\u221e} 2^{-(m+n-1)} \u03a0_{i=m}^{m+n-2}(1\u22122^{-i}).   (10)\n\n--------------------------------------------------------------------\n4.  A closed expression for T\u2099\n--------------------------------------------------------------------\nExpand the product in (10):\n\n\u03a0_{i=m}^{m+n-2}(1\u22122^{-i})\n     = \u2211_{r=0}^{n-1} (\u22121)^r\n       \u2211_{m \u2264 i\u2081 < \u2026 < i_r \u2264 m+n-2} 2^{-(i\u2081+\u2026+i_r)}.\n\nMultiplying by the leading factor 2^{-(m+n-1)} turns each term into\n\u00b1 2^{-[(m+n-1)+i\u2081+\u2026+i_r]}.\nThe exponent is always a multiple of n\n(it equals n\u00b7(m + i\u2081\u2212m + \u2026 + i_r\u2212m + 1) ).\nConversely, every multiple of n larger than 0 occurs exactly once,\nand always with the positive sign.\nHence\n\nT\u2099 = \u2211_{q = 1}^{\u221e} 2^{-qn} = 2^{-n}/(1 \u2212 2^{-n})\n    = 1/(2^{n} \u2212 1).                                      (11)\n\n--------------------------------------------------------------------\n5.  Finishing the induction\n--------------------------------------------------------------------\nWith (9), (7) and (11),\n\nS\u2099 = S\u2099\u208b\u2081 + 1/(2^{n} \u2212 1)\n    = \u2211_{i=1}^{n-1} 1/(2^{i} \u2212 1) + 1/(2^{n} \u2212 1)\n    = \u2211_{i=1}^{n}    1/(2^{i} \u2212 1).                       (12)\n\nBecause (6) starts the induction, (12) holds for every n.\n\n--------------------------------------------------------------------\n6.  Expected value of Y\u2099\n--------------------------------------------------------------------\nInsert S\u2099 from (12) into (4):\n\nE[Y\u2099] = n + \u2211_{i=1}^{n} 1/(2^{i} \u2212 1)\n       = \u2211_{i=1}^{n} ( 1 + 1/(2^{i} \u2212 1) )\n       = \u2211_{i=1}^{n} 2^{i}/(2^{i} \u2212 1).             \u25a1\n\n\nFinal answer\n\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\\displaystyle\\boxed{\\;\n\\mathbb{E}[Y_{n}] \\;=\\; \\sum_{i=1}^{n}\\frac{2^{\\,i}}{2^{\\,i}-1}\\;}",
      "Let  \n\nq = 1/2\u2003and\u2003G ~ Geom(q)\u2003 ( \ud835\udc43(G = r) = q^{\\,r}, r = 1,2, \u2026 ).\n\n1\u2003A convenient description of the procedure  \n\nLabel the numbers that are still available after j\u20131 choices\n\n\u20031,2,3,\u2026 (in increasing order).  \nAt step j draw a fresh independent copy G_j of G and take the G_j \u2013th\navailable number.  \nHence the indices  \n\n\u2003G_1 , G_2 , \u2026 , G_n                (1)\n\nare independent and distributed like G.\n\n2\u2003When is the maximum \u2264 m ?  \n\nWrite S_0 ( = m ) for the amount of \u201csmall\u201d numbers 1,\u2026,m which are\nstill present before the first draw.  \nAfter j\u20131 selections the amount of small numbers that remain equals\nS_{j-1}=m-(j-1).  \nDuring step j we select a small number iff  \n\n\u2003G_j \u2264 S_{j-1}=m-j+1.\n\nConsequently\n\n\u2003Y_n \u2264 m\u2003\u21d4\u2003G_1 \u2264 m, G_2 \u2264 m-1, \u2026 , G_n \u2264 m-n+1.        (2)\n\nBecause the G_j \u2019s are independent, for m \u2265 n\u20131\n\n\u2003\ud835\udc43(Y_n \u2264 m)\n       = \u220f_{k = m-n+1}^{m} \ud835\udc43(G \u2264 k)\n       = \u220f_{k = m-n+1}^{m} ( 1 \u2013 q^{\\,k} ).            (3)\n\n(For m < n\u20131 the probability is 0, because there are not enough\ndifferent numbers 1,\u2026,m.)\n\n   Put  \n\n   a_r := \u220f_{k = r}^{r+n-1} (1 \u2013 q^{\\,k})       (r = 0,1,2,\u2026).        (4)\n\nWith m = n-1 + r, formula (3) reads \ud835\udc43(Y_n \u2264 n-1+r)=a_r.\n\n3\u2003Expectation of the maximum  \n\nFor every non\u2013negative integer t, \ud835\udc43(Y_n \u2265 t+1)=1-\ud835\udc43(Y_n \u2264 t), hence  \n\n   \ud835\udd3c[Y_n] = \u2211_{t=0}^{\u221e} \ud835\udc43(Y_n \u2265 t+1)\n          = (n-1)+\u2211_{r=0}^{\u221e}(1-a_r).               (5)\n\n(the first n\u20131 terms of the sum equal 1).\n\n4\u2003Evaluating \u2211_{r\u22650} a_r\n\nFor fixed n set  \n\n   S_n := \u2211_{r=0}^{\u221e} q^{\\,r}\\,(q^{r+1};q)_{n-1},\n   where      (x;q)_k := \u220f_{j=0}^{k-1}(1-xq^{\\,j}).          (6)\n\nBecause q=1/2, comparing (4) and (6) gives a_r = q^{\\,r}(q^{r+1};q)_{n-1},\nso \u2211_{r\u22650} a_r = S_n.\n\nLemma  \nFor every integer n\u22651 and |q|<1\n\n\u2003S_n = 1/(1-q^{\\,n}).                                (7)\n\nProof (induction on n)  \nFor n=1, S_1 = \u2211_{r\u22650} q^{\\,r}=1/(1-q).\n\nAssume (7) holds for n\u20131 (n\u22652).  A direct computation shows\n\n\u2003q^{\\,r}(q^{r+1};q)_{n-1}\n      = q^{\\,r}(q^{r+1};q)_{n-2} \u2013 q^{\\,r+n-1}(q^{r+1};q)_{n-2}.       (8)\n\nSumming (8) over r \u2265 0 yields\n\n\u2003S_n = S_{\\,n-1} \u2013 q^{\\,n-1}S_{\\,n-1}\n       = (1-q^{\\,n-1})S_{\\,n-1}.                        (9)\n\nBy the induction hypothesis S_{\\,n-1}=1/(1-q^{\\,n-1}); inserting this in\n(9) gives S_n = 1/(1-q^{\\,n}), which is exactly (7). \u220e\n\nWith q = 1/2 we therefore have  \n\n   \u2211_{r=0}^{\u221e} a_r = S_n = 1/(1-2^{-n}).              (10)\n\n5\u2003Finishing the calculation\n\nInsert (10) into (5):\n\n\u2003\ud835\udd3c[Y_n]\n     = (n-1) + (1 - (1-2^{-n})) /(1-2^{-n})\n     = (n-1) + 2^{-n}/(1-2^{-n})\n     = (n-1) + 2^{\\,n}/(2^{\\,n}-1).                    (11)\n\nFinally note that\n\n\u2003(n-1) + 2^{\\,n}/(2^{\\,n}-1)\n     = \u2211_{i=1}^{n-1} 1 + 2^{\\,n}/(2^{\\,n}-1)\n     = \u2211_{i=1}^{n} \\frac{2^{\\,i}}{2^{\\,i}-1}.          (12)\n\nThus\n\n\u2003\ud835\udd3c[Y_n] = \u2211_{i=1}^{n} \\frac{2^{\\,i}}{2^{\\,i}-1},\n\nexactly as was to be shown.\n\nFinal answer  \n\\[\n\\boxed{\\displaystyle \\mathbb{E}[Y_n]=\\sum_{i=1}^{n}\\frac{2^{\\,i}}{2^{\\,i}-1}}\n\\]",
      "Let  \n\nY\u2099 = max{ X\u2081 ,\u2026, X\u2099 } .\n\n1.  A closed formula for  P( Y\u2099 \u2264 k )\n\nSuppose k \u2265 n.  \nAfter j (0 \u2264 j < n) choices we have already picked j different numbers, all \u2264 k, whence\nk \u2212 j of the numbers 1,\u2026,k are still available and they are precisely the first k \u2212 j\nnumbers in the ordered list of all still\u2013unused positive integers.  \nBecause the next choice is the i-th smallest remaining number with probability 2\u207b\u2071,\nthe probability that it is again \u2264 k equals  \n\n\u2003\u20031 \u2212 2^{\u2212(k\u2212j)}.\n\nHence  \n\n\u2003\u2003P( Y\u2099 \u2264 k ) = \u220f_{i=k\u2212n+1}^{k} ( 1 \u2212 2^{\u2212i} )             (k \u2265 n).     (1)\n\n(For k < n the probability is 0, since at least n distinct numbers have been chosen.)\n\n--------------------------------------------------------------------\n2.  Expressing E[Y\u2099] through tail probabilities\n\nFor a non\u2013negative, integer\u2013valued random variable Z we have  \n\n\u2003\u2003E[ Z ] = \u03a3_{t=1}^{\u221e} P( Z \u2265 t ).\n\nBecause Y\u2099 \u2265 n always,  \n\n\u2003\u2003E[ Y\u2099 ] = n + \u03a3_{m=0}^{\u221e} P( Y\u2099 \u2265 n+1+m )\n           = n + \u03a3_{m=0}^{\u221e} ( 1 \u2212 P( Y\u2099 \u2264 n+m ) ).\n\nWith (1) we obtain  \n\n\u2003\u2003E[ Y\u2099 ] = n + \u03a3_{m=0}^{\u221e} ( 1 \u2212 \u220f_{j=1}^{n} ( 1 \u2212 2^{-(m+j)} ) ).    (2)\n\nDenote  \n\n\u2003\u2003S\u2099 := \u03a3_{m=0}^{\u221e} ( 1 \u2212 \u220f_{j=1}^{n} ( 1 \u2212 2^{-(m+j)} ) );     (3)\n\nthen E[ Y\u2099 ] = n + S\u2099.\n\n--------------------------------------------------------------------\n3.  Evaluation of S\u2099\n\nWe prove inductively that  \n\n\u2003\u2003S\u2099 = \u03a3_{i=1}^{n} 1 / ( 2^{i} \u2212 1 ).                            (4)\n\nBase n = 1.  \nS\u2081 = \u03a3_{m=0}^{\u221e} 2^{-(m+1)} = 1 = 1/(2\u00b9 \u2212 1).\n\nInduction step.  Put  \n\n\u2003\u2003T\u2099 := S\u2099 \u2212 S_{n\u22121}\n      = \u03a3_{m=0}^{\u221e} 2^{-(m+n)} \u220f_{j=1}^{n-1} ( 1 \u2212 2^{-(m+j)} ).    (5)\n\nSet  \n\n\u2003\u2003p_m := \u220f_{j=0}^{n-1} ( 1 \u2212 2^{-(m+j)} ).\n\nBecause 2^{-(m+n)} p_m = p_m /(2^{m+n}), the m-th summand in (5) can be rewritten as  \n\n\u2003\u2003t_m := 2^{-(m+n)} \u220f_{j=1}^{n-1} ( 1 \u2212 2^{-(m+j)} )\n          = p_m /(2^{m+n} \u2212 1) \u2212 p_{m+1}/(2^{m+n+1} \u2212 1).         (6)\n\nThus the series for T\u2099 telescopes:\n\n\u2003\u2003T\u2099 = lim_{M\u2192\u221e} \u03a3_{m=0}^{M} ( t_m )\n         = lim_{M\u2192\u221e} ( p_0 /(2^{n} \u2212 1) \u2212 p_{M+1}/(2^{M+n+1} \u2212 1) )\n         = 1 / ( 2^{n} \u2212 1 )                                      (7)\n\nbecause 0 < p_{M+1} < 1 and the denominator tends to \u221e.\n\nTherefore T\u2099 = 1/(2^{n} \u2212 1) and\n\n\u2003\u2003S\u2099 = S_{n\u22121} + 1/(2^{n} \u2212 1).\n\nStarting with S\u2081 = 1/(2 \u2212 1) and iterating gives (4).\n\n--------------------------------------------------------------------\n4.  The expected maximum\n\nInsert (4) into (2):\n\n\u2003\u2003E[ Y\u2099 ] = n + \u03a3_{i=1}^{n} 1/(2^{i} \u2212 1)\n           = \u03a3_{i=1}^{n} ( 1 + 1/(2^{i} \u2212 1) )\n           = \u03a3_{i=1}^{n} 2^{i} / ( 2^{i} \u2212 1 ).\n\n--------------------------------------------------------------------\nFinal answer\n\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\n\u2003\u2003\\boxed{\\,\\displaystyle \\mathbb{E}[Y_n]=\\sum_{i=1}^{n}\\frac{2^{i}}{2^{i}-1}\\,}."
    ],
    "variant_times": [
      920.3854908943176,
      456.64034700393677,
      321.64153599739075
    ],
    "final": "Let  \n\n\u2003\u2003Y_n=\\max\\{X_1,\\dots ,X_n\\}, \\qquad n\\ge 1.  \n\nThroughout we use the classical identity for a non\u2013negative, integer\u2013valued random\nvariable Z  \n\n\u2003\u2003E[Z]=\\sum_{k\\ge 1}\\Pr(Z\\ge k).\u2003\u2003(1)\n\n--------------------------------------------------------------------\n1.  An equivalent description of the experiment\n--------------------------------------------------------------------\nAfter j\u22121 numbers have been removed, list the remaining integers in\nincreasing order.  \nThe next number chosen is the r-th one in this list with probability 2^{-r}\n(r=1,2,\\dots).  \nHence the ranks  \n\n\u2003\u2003G_1,G_2,\\dots ,G_n                        (2)\n\nof the n successive choices are independent and identically\ndistributed with  \n\n\u2003\u2003Pr(G_j=r)=2^{-r}\\;(r\\ge 1).               (3)\n\n--------------------------------------------------------------------\n2.  Distribution of Y_n\n--------------------------------------------------------------------\nFix m\\ge n.  \nImmediately before the j-th draw exactly m-j+1 of the still\navailable numbers do not exceed m; therefore  \n\n\u2003\u2003Y_n\\le m\\;\\Longleftrightarrow\\;G_1\\le m,\\;G_2\\le m-1,\\dots ,\n\u2003\u2003G_n\\le m-n+1.\n\nUsing independence and (3),\n\n\u2003\u2003Pr(Y_n\\le m)=\\prod_{i=m-n+1}^{m}(1-2^{-i}),\u2003\u2003m\\ge n,     (4)\n\nwhile Pr(Y_n\\le m)=0 for m<n.\n\n--------------------------------------------------------------------\n3.  Expressing the expectation through tail probabilities\n--------------------------------------------------------------------\nBecause Y_n\\ge n always, (1) and (4) give\n\nE[Y_n]=n+\\sum_{m=0}^{\\infty}\n        \\Bigl(1-\\prod_{i=m+1}^{m+n}(1-2^{-i})\\Bigr).    (5)\n\nWrite\n\n\u2003\u2003S_n:=\\sum_{m=0}^{\\infty}\n             \\Bigl(1-\\prod_{i=m+1}^{m+n}(1-2^{-i})\\Bigr);        (6)\n\nthen E[Y_n]=n+S_n.\n\n--------------------------------------------------------------------\n4.  Evaluation of S_n\n--------------------------------------------------------------------\nWe prove inductively that  \n\n\u2003\u2003S_n=\\sum_{i=1}^{n}\\frac{1}{2^{i}-1}.                  (7)\n\nBase n=1.  Formula (6) yields S_1=\\sum_{m\\ge 0}2^{-(m+1)}=1, which is (7).\n\nInduction step.  Put\n\nT_n:=S_n-S_{n-1}\n    =\\sum_{m=0}^{\\infty}\n        2^{-(m+n)}\\prod_{i=m+1}^{m+n-1}(1-2^{-i}).       (8)\n\nExpand the product by inclusion\u2013exclusion.\nEvery term that appears is \u00b12^{-q n} for some integer q\\ge 1, and each\npower 2^{-qn} occurs exactly once with sign +.  Consequently\n\n\u2003\u2003T_n=\\sum_{q\\ge 1}2^{-qn}=\\frac{1}{2^{n}-1}.           (9)\n\nTherefore, using the induction hypothesis,\n\nS_n=S_{n-1}+T_n\n    =\\sum_{i=1}^{n-1}\\frac{1}{2^{i}-1}+\\frac{1}{2^{n}-1}\n    =\\sum_{i=1}^{n}\\frac{1}{2^{i}-1},                   (10)\n\ncompleting the induction.\n\n--------------------------------------------------------------------\n5.  The expected maximum\n--------------------------------------------------------------------\nInsert (7) into (5):\n\nE[Y_n]=n+\\sum_{i=1}^{n}\\frac{1}{2^{i}-1}\n      =\\sum_{i=1}^{n}\\Bigl(1+\\frac{1}{2^{i}-1}\\Bigr)\n      =\\sum_{i=1}^{n}\\frac{2^{i}}{2^{i}-1}.            (11)\n\n--------------------------------------------------------------------\nFinal answer\n\\[\n\\boxed{\\displaystyle \\mathbb{E}[Y_n]=\\sum_{i=1}^{n}\\frac{2^{\\,i}}{2^{\\,i}-1}}\n\\]",
    "final_time": 30.36708927154541,
    "total_problem_time": 1729.0344631671906
  },
  {
    "id": "problem_10",
    "round": "Day 2",
    "variants": [
      "Put  \n\nf(n)= the square\u2013free kernel of n(n+1), i.e.  \nf(n)=\u220fp \u2006 (prime) \u2006 p \u2003iff\u2003v p (n(n+1)) is odd.  \n\nBecause n and n+1 are coprime, f(n) is square\u2013free and\n\n(a\u00b2+a)(b\u00b2+b) is a square\u2003\u21d4\u2003f(a)=f(b).                (1)\n\nFor 1\u2264n\u2264N write  \n\nm d (N)=|{n\u2264N : f(n)=d }| \u2003(d square\u2013free).\n\nWith (1)\n\nS N =\u2211d m d (N)\u00b2 =N+\u2211d m d (N)(m d (N)-1).             (2)\n\n(the term N comes from the diagonal a=b).\n\nWe prove that the second summand in (2) is o(N); then\n\nlim N\u2192\u221e S N /N =1.\n\n--------------------------------------------------\n1.  Estimating m d (N)\n\nPut x= n, y=\u221a{ n(n+1)/d }.  \nEquation f(n)=d is equivalent to  \n\nx(x+1)=d y\u00b2.                                     (3)\n\nMultiply (3) by 4 and set X=2x+1, Y=2y; then\n\nX\u00b2-4dY\u00b2 =1,\u2003\u2003X odd, Y even.                     (4)\n\n(4) is a Pell equation with parameter D=4d.  \nAll its positive solutions are obtained from the\nfundamental solution (X 1 ,Y 1 ) by\n\nX k +Y k \u221aD =(X 1 +Y 1 \u221aD) k \u2003\u2003(k=0,1,2,\u2026).\n\nHence the X\u2013components grow exponentially:\n\nX k \u2265(X 1 +Y 1 \u221aD) k /2 \u2265\u03b5 d k ,      \u03b5 d :=X 1 +Y 1 \u221aD  >1.\n\nConsequently the number of solutions of (4) with\nX\u22642N+1 is at most\n\nm d (N) \u2264 1 + log(2N+1)/log \u03b5 d .                (5)\n\nBecause \u03b5 d >\u221aD =2\u221ad  we get the useful bound\n\nm d (N) \u2264 1 + log(2N)/log(2\u221ad) \u2264 C\u00b7log N /\u221ad     (6)\n\nwith an absolute constant C.\n\n--------------------------------------------------\n2.  The set of d with m d (N) \u22652\n\nFrom (6) we have m d (N)=1 whenever d> (log N)\u00b2 .\nHence\n\nT N :={d square-free : m d (N) \u22652 } \u2282 {d\u2264(log N)\u00b2}.  (7)\n\n--------------------------------------------------\n3.  The number of \u201cextra\u2019\u2019 pairs\n\nWrite  \n\nE N :=\u2211d m d (N)(m d (N)-1)           (the second term in (2)).\n\nSplit the sum into d\u2208T N and d\u2209T N .\n\n(i)  d\u2209T N \u2003\u21d2\u2003m d (N)=1\u2003\u21d2\u2003contribution 0.\n\n(ii) For d\u2208T N we use (6):\n\nm d (N) \u2264 C log N , so m d (N)(m d (N)-1) \u2264 C\u00b2 (log N)\u00b2 .\n\nBecause of (7) the number of such d is \u2264(log N)\u00b2 , whence\n\nE N \u2264 (log N)\u00b2 \u00b7 C\u00b2 (log N)\u00b2 = C\u00b2 (log N)^4 = o(N).   (8)\n\n--------------------------------------------------\n4.  Finishing the estimate\n\nInsert (8) in (2):\n\nS N =N+E N = N+o(N).\n\nTherefore   \n\nlim N\u2192\u221e S N /N =1.\n\n--------------------------------------------------\nFinal answer  \n1",
      "(Sorry, I was not able to finish.)",
      "Let  \n\nf(n)=n^{2}+n=n(n+1),\\qquad n\\in \\mathbb Z_{>0}.  \n\nFor 1\\le a,b\\le N put  \n\nS_N=\\#\\{(a,b)\\ :\\; f(a)f(b)\\ \\hbox{is a square}\\} .\n\n------------------------------------------------------------------\n1.  Reformulation through \u201csquare\u2013free parts\u201d\n------------------------------------------------------------------\nFor every n there are unique integers\n\nn(n+1)=s(n)\\,t(n)^{2},\\qquad s(n)\\ \\hbox{square\u2013free},\\;t(n)\\ge 1.\n\nCall s(n) the square\u2013free part of f(n).  \nBecause consecutive integers are coprime, s(n) is obtained by deleting\nfrom n and n+1 every prime factor occurring with an even exponent.\nConsequently\n\nf(a)f(b)\\hbox{ is a square } \\Longleftrightarrow s(a)=s(b).\n\nHence, putting  \n\nc_{N}(s)=\\#\\{\\,1\\le n\\le N : s(n)=s\\,\\},  \n\nwe have\n\n(1)\u2003\u2003S_N=\\sum_{s} c_{N}(s)^{2}.                     \n\n(The sum is over all square\u2013free positive integers.)\n\n------------------------------------------------------------------\n2.  An upper bound for the individual multiplicities c_{N}(s)\n------------------------------------------------------------------\nFix a square-free s.  \nWriting 4f(n)=4n(n+1)=(2n+1)^{2}-1 we get\n\n(2n+1)^{2}-4s\\,t^{2}=1,\\qquad t=t(n).\n\nThus every n with s(n)=s furnishes a positive solution (x,y)=(2n+1,2t)\nof the Pell equation\n\nx^{2}-4s\\,y^{2}=1.                                            (2)\n\nConversely, every solution (x,y) with x odd gives n=(x-1)/2\\in\\mathbb Z.\nStandard theory of Pell equations says that the total number of\npositive solutions with x\\le X is O(\\log X).  With X=2N+1 we obtain\n\n(3)\u2003\u2003\u2003c_{N}(s)=O(\\log N)\\qquad(\\forall s).                     \n\nThe implicit constant in (3) is absolute.\n\n------------------------------------------------------------------\n3.  A global upper bound for S_N\n------------------------------------------------------------------\nFrom (1) and (3):\n\nS_N=\\sum_{s} c_{N}(s)^{2}\\le\n(\\max_{s}c_{N}(s))\\sum_{s}c_{N}(s)=O(\\log N)\\cdot N\n=O\\!\\bigl(N\\log N\\bigr).                                (4)\n\n------------------------------------------------------------------\n4.  A global lower bound for S_N\n------------------------------------------------------------------\nStill by (3), every square\u2013free s that actually occurs before N is\ntaken at most C\\log N times (C absolute).  Hence the number\nD_N of distinct square-free parts that do occur satisfies  \n\nD_N\\ge \\dfrac{N}{C\\log N}.                               (5)\n\nApply Cauchy\u2019s inequality to the family (c_{N}(s))_{s}:\n\nS_N=\\sum_{s}c_{N}(s)^{2}\\;\\ge\\;\n\\frac{\\bigl(\\sum_{s}c_{N}(s)\\bigr)^{2}}{D_N}\n=\\frac{N^{2}}{D_N}\\;\\ge\\; \\frac{N^{2}}{N/(C\\log N)}\n= C\\,N\\log N.                                           (6)\n\nThus\n\n(7)\u2003\u2003C\\,N\\log N\\;\\le\\;S_N\\;\\le\\;C'\\,N\\log N.\n\n------------------------------------------------------------------\n5.  The order of growth of S_N / N\n------------------------------------------------------------------\nDivide (7) by N:\n\nC\\log N\\;\\le\\;\\frac{S_N}{N}\\;\\le\\;C'\\log N.              (8)\n\nBecause log N\u2192\u221e, the quotient S_N/N grows without bound; in particular\n\nlim_{N\\to\\infty}\\dfrac{S_N}{N}=+\\infty.                 (9)\n\n------------------------------------------------------------------\n6.  Conclusion\n------------------------------------------------------------------\nThe limit exists in the (extended) real line and equals +\u221e.\n\nFinal answer:\u2003displaystyle\\boxed{\\;\\lim_{N\\to\\infty}\\dfrac{S_N}{N}=+\\infty\\;}"
    ],
    "variant_times": [
      2206.0435678958893,
      337.39723920822144,
      925.5356900691986
    ],
    "final": "Solution.\n\n1.  A reformulation  \nFor every positive integer put  \n\n\u2003\u2003f(n)=n^{2}+n=n(n+1),\u2003\u2003s(n)=square-free part of f(n).\n\nBecause n and n+1 are coprime, s(n) is the product of all primes that\noccur in f(n) with an odd exponent, hence s(n) is square-free.\nFor two positive integers a,b we have   \n\n\u2003\u2003f(a)f(b)\\text{ is a square }  \\Longleftrightarrow s(a)=s(b).\u2003(1)\n\nIndeed, (1) follows by comparing the parities of the exponents of every\nprime in f(a) and f(b).\n\nDenote  \n\n\u2003\u2003m_{d}(N)=\\#\\{\\,1\\le n\\le N : s(n)=d\\},\\qquad\n\u2003\u2003d \\text{ square-free}.  \n\nWith (1)\n\n\u2003\u2003S_{N}= \\#\\{(a,b)\\le N : f(a)f(b)\\text{ is a square}\\}\n\u2003\u2003     =\\sum_{d} m_{d}(N)^{2}.\u2003(2)\n\nOur task is to evaluate S_{N}.\n\n--------------------------------------------------------------------\n2.  How large can m_{d}(N) be?  \n--------------------------------------------------------------------\nFix a square-free d and look at the equation\n\n\u2003\u2003n(n+1)=d\\,k^{2},\u2003\u2003n,k\\in\\mathbb Z_{>0}.\u2003(3)\n\nIt describes exactly the integers n with s(n)=d.\nMultiply (3) by 4 and set  \n\n\u2003\u2003X=2n+1\\;(>0),\u2003Y=2k\\;(>0);  \n\nthen (3) becomes the Pell equation  \n\n\u2003\u2003X^{2}-4d\\,Y^{2}=1,\u2003\u2003X\\text{ odd},\\;Y\\text{ even}.\u2003(4)\n\nEvery Pell equation x^{2}-Dy^{2}=1 (D not a square) has infinitely\nmany positive solutions; ordered by the x\u2013coordinate they grow\ngeometrically: if (X_{1},Y_{1}) is the minimal positive solution, then\n\n\u2003\u2003X_{k}+Y_{k}\\sqrt{4d}=(X_{1}+Y_{1}\\sqrt{4d})^{\\,k}\\qquad(k=0,1,2,\\dots).\n\nConsequently, for some constant \u03b5_{d}>1 that depends only on d,\n\n\u2003\u2003X_{k}\\ge\\varepsilon_{d}^{\\,k}.  \n\nHence the number of solutions with X\\le 2N+1 (and therefore\nn\\le N) is at most\n\n\u2003\u2003m_{d}(N)\\le 1+\\frac{\\log(2N+1)}{\\log\\varepsilon_{d}}.\u2003(5)\n\nA crude universal estimate is enough for us.  \nBecause \u03b5_{d}>2\\sqrt{d} (take, for instance, X_{1}+Y_{1}\\sqrt{4d}\\ge\n1+2\\sqrt{d}), we get from (5)\n\n\u2003\u2003m_{d}(N)\\le\n\u2003\u20031+\\frac{\\log(2N)}{\\log(2\\sqrt{d})}\n\u2003\u2003\\le C\\frac{\\log N}{\\sqrt{d}}                       (6)\n\nwith an absolute constant C.\n\n--------------------------------------------------------------------\n3.  Which d can occur more than once?  \n--------------------------------------------------------------------\nIf m_{d}(N)\\ge 2, then (6) gives  \n\n\u2003\u20032\\le m_{d}(N)\\le C\\frac{\\log N}{\\sqrt{d}}\n\u2003\u2003\\Longrightarrow d\\le C^{2}(\\log N)^{2}.           (7)\n\nThus only square-free d up to (const.)\u00b7(log N)^{2} may have multiplicity\n\u22652.  Put  \n\n\u2003\u2003T_{N}:=\\{d\\text{ square-free}: m_{d}(N)\\ge 2\\}.  \n\nBy (7) we have  \n\n\u2003\u2003\\#T_{N}\\le C_{1}(\\log N)^{2}.                      (8)\n\n--------------------------------------------------------------------\n4.  The \u201cextra\u2019\u2019 pairs  \n--------------------------------------------------------------------\nRewrite (2) as  \n\n\u2003\u2003S_{N}=N+\\!\\!\\sum_{d} m_{d}(N)\\bigl(m_{d}(N)-1\\bigr)\n\u2003\u2003   =: N+E_{N}.                                     (9)\n\n(The term N corresponds to the diagonal a=b.)\nIf d\\notin T_{N} then m_{d}(N)=1 and its contribution to E_{N} is 0.\nFor d\u2208T_{N} we combine (6) with (8):\n\n\u2003\u2003m_{d}(N)(m_{d}(N)-1)\\le m_{d}(N)^{2}\n\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2264\\frac{C^{2}(\\log N)^{2}}{d}.  \n\nHence, using that d\u2264C^{2}(\\log N)^{2} on T_{N},\n\n\u2003\u2003E_{N}\\le C^{2}(\\log N)^{2}\\!\\!\\sum_{d\\in T_{N}}\\frac1{d}\n\u2003\u2003     \u2264 C^{2}(\\log N)^{2}\\!\\!\\sum_{1\\le d\\le C^{2}(\\log N)^{2}}\\frac1{d}\n\u2003\u2003     = O\\bigl((\\log N)^{2}\\log\\log N\\bigr).        (10)\n\n--------------------------------------------------------------------\n5.  Asymptotics of S_{N}  \n--------------------------------------------------------------------\nBecause (\\log N)^{2}\\log\\log N=o(N), relation (10) together with (9)\ngives\n\n\u2003\u2003S_{N}=N+o(N)\\quad(N\\to\\infty).                     (11)\n\nDivide by N and take the limit:\n\n\u2003\u2003\\lim_{N\\to\\infty}\\frac{S_{N}}{N}=1.                (12)\n\n--------------------------------------------------------------------\nFinal answer  \n1",
    "final_time": 109.09957766532898,
    "total_problem_time": 3578.0760748386383
  },
  {
    "timing_summary": {
      "model_name": "gpt",
      "total_model_time": 7559.288578748703,
      "problems_count": 5,
      "average_time_per_problem": 1511.8577157497407
    }
  }
]