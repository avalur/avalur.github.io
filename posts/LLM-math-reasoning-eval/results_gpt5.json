[
  {
    "id": "problem_1",
    "round": "Day 1",
    "variants": [
      "Let P \u2208 \u211d[x] with deg P \u2265 2. For x \u2208 \u211d, the tangent line at (x, P(x)) has equation\ny = P(x) + P\u2032(x)(t \u2212 x).\nA point (a, b) lies on this line if and only if\nb = P(x) + P\u2032(x)(a \u2212 x).\nThus, for fixed a, the set of values of b that are attained by tangent lines at abscissa a is the image of the function\nG_a(x) := P(x) + P\u2032(x)(a \u2212 x).\n\n(a) deg P odd implies \u22c3_x \u2113_x = \u211d\u00b2.\n\nLet deg P = n be odd and let c be the leading coefficient of P, so P(x) = c x^n + lower order terms. Then\nG_a(x) = P(x) + aP\u2032(x) \u2212 xP\u2032(x).\nThe coefficient of x^n in G_a is\ncoeff(x^n) = c \u2212 n c = (1 \u2212 n)c \u2260 0\n(since n \u2265 2). Therefore deg G_a = n is odd. For any b \u2208 \u211d, the polynomial equation\nG_a(x) \u2212 b = 0\nhas odd degree, hence at least one real root. Thus for every (a, b) \u2208 \u211d\u00b2 there exists x with b = P(x) + P\u2032(x)(a \u2212 x), i.e., (a, b) lies on the tangent at x. Hence the union of all tangent lines is all of \u211d\u00b2.\n\n(b) No even-degree polynomial has this property.\n\nSuppose deg P = n is even. As above,\nG_a(x) = P(x) + aP\u2032(x) \u2212 xP\u2032(x)\nhas leading term (1 \u2212 n)c x^n with (1 \u2212 n)c \u2260 0, so deg G_a = n is even. Hence as x \u2192 \u00b1\u221e, G_a(x) \u2192 \u00b1\u221e with the same sign, so the image of G_a is an interval of the form (\u2212\u221e, M] or [m, \u221e). In particular, G_a is not surjective onto \u211d. Therefore, for this fixed a, there exist b for which the equation b = G_a(x) has no real solution, i.e., some points (a, b) do not lie on any tangent line. Consequently, no polynomial of even degree can have \u22c3_x \u2113_x = \u211d\u00b2.\n\nA concrete illustration: for P(x) = x\u00b2, G_a(x) = 2ax \u2212 x\u00b2, whose range is (\u2212\u221e, a\u00b2], not all of \u211d.\n\nFinal answer.\n(a) True for any odd-degree polynomial P: the union of its tangent lines is all of \u211d\u00b2.\n(b) No. There is no polynomial of even degree whose tangent lines cover \u211d\u00b2.",
      "Let P be a real polynomial of degree n \u2265 2, with leading coefficient c \u2260 0. For each x \u2208 \u211d, the tangent line at (x, P(x)) is\n\u2113_x = { (t, P(x) + P\u2032(x)(t \u2212 x)) : t \u2208 \u211d }.\n\nA point (a, b) \u2208 \u211d^2 lies on \u2113_x iff\nb = P(x) + P\u2032(x)(a \u2212 x).\n\nDefine, for each fixed a \u2208 \u211d,\nH_a(x) = P(x) + (a \u2212 x) P\u2032(x).\nThen (a, b) lies on some tangent line iff the equation H_a(x) = b has a real solution x.\n\nCompute the degree and leading coefficient of H_a. If P(x) = c x^n + lower terms, then P\u2032(x) = n c x^{n\u22121} + lower, and hence\nH_a(x) = c x^n + (a \u2212 x)(n c x^{n\u22121}) + lower\n= (1 \u2212 n) c x^n + n a c x^{n\u22121} + lower.\nThus deg(H_a) = n and its leading coefficient is (1 \u2212 n)c \u2260 0.\n\n(a) If n is odd, then H_a is an odd-degree polynomial, hence\nlim_{x\u2192+\u221e} H_a(x) and lim_{x\u2192\u2212\u221e} H_a(x) have opposite signs.\nBy continuity, H_a(\u211d) = \u211d. Therefore for every a, b \u2208 \u211d there exists x with H_a(x) = b, which means every point (a, b) lies on some tangent line. Hence \u22c3_{x\u2208\u211d} \u2113_x = \u211d^2.\n\n(b) If n is even, then H_a has even degree with leading coefficient (1 \u2212 n)c. There are two cases:\n- If c > 0, then (1 \u2212 n)c < 0, so H_a(x) \u2192 \u2212\u221e as x \u2192 \u00b1\u221e. Thus H_a is bounded above on \u211d. For any b larger than sup H_a(\u211d), the equation H_a(x) = b has no real solution, so points (a, b) with such b are not covered by the union of tangents.\n- If c < 0, then (1 \u2212 n)c > 0, so H_a(x) \u2192 +\u221e as x \u2192 \u00b1\u221e, and H_a is bounded below. For any b smaller than inf H_a(\u211d), there is no solution, hence such points are not covered.\n\nIn either case, for even n there exist points (a, b) not lying on any tangent line. Therefore no polynomial of even degree has \u22c3_{x\u2208\u211d} \u2113_x = \u211d^2.\n\nFinal answer.\n(a) True: for odd deg(P), \u22c3_{x\u2208\u211d} \u2113_x = \u211d^2.\n(b) No: for even deg(P), the union of tangent lines cannot be all of \u211d^2.",
      "Let P be a real polynomial of degree n \u2265 2, and for each x \u2208 R let \u2113x be the tangent line to the graph of P at (x, P(x)). A convenient representation of \u2113x is\ny = P(x) + P\u2032(x)(t \u2212 x),\nso that for a fixed abscissa t, the intersection of \u2113x with the vertical line t = const has ordinate\nLx(t) = P(x) \u2212 xP\u2032(x) + tP\u2032(x).\n\n(a) Degree of P odd \u21d2 \u22c3x \u2113x = R^2.\n\nFix an arbitrary point (u, v) \u2208 R^2. Consider the polynomial in x\nF(x) = P(x) + P\u2032(x)(u \u2212 x) \u2212 v = [P(x) \u2212 xP\u2032(x)] + uP\u2032(x) \u2212 v.\nIf deg P = n with leading coefficient an \u2260 0, then\nP(x) \u2212 xP\u2032(x) = an x^n \u2212 n an x^n + lower degree terms = (1 \u2212 n) an x^n + (lower),\nwhile uP\u2032(x) has degree at most n \u2212 1. Hence deg F = n and its leading coefficient is (1 \u2212 n) an \u2260 0. In particular, if n is odd, then F is an odd-degree real polynomial, so\nlimx\u2192\u221e F(x) and limx\u2192\u2212\u221e F(x) have opposite signs. By the intermediate value theorem there exists x0 with F(x0) = 0, i.e.,\nv = P(x0) + P\u2032(x0)(u \u2212 x0),\nso (u, v) lies on the tangent line at x0. Since (u, v) was arbitrary, \u22c3x \u2113x = R^2.\n\n(b) No even-degree polynomial has this property.\n\nAssume deg P = n is even with leading coefficient an. Fix u \u2208 R and consider the function of x\nHu(x) = Lx(u) = P(x) \u2212 xP\u2032(x) + uP\u2032(x).\nAs above, Hu is a polynomial in x of degree n with leading coefficient (1 \u2212 n) an. Since n \u2265 2, 1 \u2212 n < 0.\n\n- If an > 0, then (1 \u2212 n) an < 0, so Hu(x) \u2192 \u2212\u221e as x \u2192 \u00b1\u221e. Hence Hu attains a finite global maximum M(u), and the set {Hu(x) : x \u2208 R} is contained in (\u2212\u221e, M(u)]. Thus no tangent line meets the vertical line t = u above height M(u), so points (u, v) with v > M(u) are not covered.\n\n- If an < 0, the same reasoning shows Hu(x) \u2192 +\u221e as x \u2192 \u00b1\u221e, so Hu attains a finite global minimum m(u), and no tangent line meets t = u below height m(u). Points (u, v) with v < m(u) are not covered.\n\nTherefore for any even-degree polynomial P, the union of tangent lines cannot be all of R^2.\n\nFinal answer:\n(a) True: for odd degree P, \u22c3x \u2113x = R^2.\n(b) No: for every even-degree polynomial P, the union of tangent lines misses some points, so the equality fails."
    ],
    "variant_times": [
      54.068278074264526,
      98.03820610046387,
      94.42892909049988
    ],
    "final": "Let P \u2208 R[x] with deg P = n \u2265 2, and for x \u2208 R let \u2113_x be the tangent line to the graph of P at (x, P(x)):\n\u2113_x = { (t, P(x) + P\u2032(x)(t \u2212 x)) : t \u2208 R }.\n\nA point (a, b) lies on \u2113_x iff\nb = P(x) + P\u2032(x)(a \u2212 x).\n\nFor fixed a, define\nH_a(x) = P(x) + (a \u2212 x)P\u2032(x).\nThen (a, b) lies on some tangent line iff the equation H_a(x) = b has a real solution x.\n\nCompute the leading term of H_a. If P(x) = c x^n + (lower terms) with c \u2260 0, then P\u2032(x) = n c x^{n\u22121} + (lower terms), and hence\nH_a(x) = c x^n + a(n c x^{n\u22121}) \u2212 x(n c x^{n\u22121}) + (lower terms)\n= (1 \u2212 n)c x^n + (lower terms).\nBecause n \u2265 2, (1 \u2212 n)c \u2260 0, so deg H_a = n.\n\n(a) If n is odd, H_a has odd degree, so lim_{x\u2192+\u221e} H_a(x) and lim_{x\u2192\u2212\u221e} H_a(x) have opposite signs. By continuity, H_a(R) = R. Thus for every (a, b) \u2208 R^2 there exists x with H_a(x) = b, i.e., every point lies on some tangent line. Hence \u22c3_{x\u2208R} \u2113_x = R^2.\n\n(b) If n is even, then H_a has even degree with leading coefficient (1 \u2212 n)c. Consequently, H_a(x) \u2192 \u2212\u221e as x \u2192 \u00b1\u221e when c > 0, and H_a(x) \u2192 +\u221e as x \u2192 \u00b1\u221e when c < 0. In either case, H_a is bounded on one side (has a finite global maximum if c > 0, or a finite global minimum if c < 0). Therefore, for this fixed a, there exist b for which H_a(x) = b has no real solution. Hence the vertical line t = a contains points not lying on any tangent line, and \u22c3_{x\u2208R} \u2113_x \u2260 R^2 for every even-degree polynomial.\n\nFinal answer.\n(a) True: if deg P is odd, then \u22c3_{x\u2208R} \u2113_x = R^2.\n(b) No: for every even-degree polynomial P, \u22c3_{x\u2208R} \u2113_x \u2260 R^2.",
    "final_time": 28.981847047805786,
    "total_problem_time": 275.51726031303406
  },
  {
    "id": "problem_2",
    "round": "Day 1",
    "variants": [
      "Let J(f) = \u222b_{-1}^{1} (f''(x))^2 dx. We minimize J(f) under the constraints\n- f(1) = f(-1) = 1 (fixed endpoint values),\n- \u222b_{-1}^{1} f(x) dx = 0 (integral constraint).\n\n1) Euler\u2013Lagrange equation and natural boundary conditions\n\nIntroduce a Lagrange multiplier \u03bb for the integral constraint and consider\nI(f) = \u222b_{-1}^{1} [(f''(x))^2 + \u03bb f(x)] dx,\nwith f(\u00b11) fixed. For variations h with h(\u00b11) = 0 we have\n0 = d/dt|_{t=0} I(f + t h) = 2 \u222b f'' h'' + \u03bb \u222b h.\n\nIntegrating by parts twice,\n\u222b f'' h'' = [f'' h']_{-1}^{1} - \u222b f''' h' = [f'' h']_{-1}^{1} - [f''' h]_{-1}^{1} + \u222b f^{(4)} h.\nSince h(\u00b11) = 0, the middle boundary term vanishes. Because h'(\u00b11) is arbitrary, the boundary term [f'' h']_{-1}^{1} vanishes for all such h only if\nf''(-1) = f''(1) = 0.\nThen the stationarity condition reduces to\n\u222b (2 f^{(4)} + \u03bb) h = 0 for all h with h(\u00b11) = 0,\nhence 2 f^{(4)} + \u03bb = 0 on [-1,1]. Therefore f^{(4)} is a constant, and so f is a quartic polynomial.\n\n2) Solving for the minimizer\n\nWrite f(x) = a x^4 + b x^3 + c x^2 + d x + e.\nFrom f''(x) = 12 a x^2 + 6 b x + 2 c and f''(\u00b11) = 0 we get\n12 a + 6 b + 2 c = 0,   12 a - 6 b + 2 c = 0\n\u21d2 b = 0, c = -6 a.\n\nFrom f(\u00b11) = 1 we get d = 0 and e = 1 + 5 a.\n\nThe integral constraint:\n0 = \u222b_{-1}^{1} f(x) dx = 2 \u222b_{0}^{1} [a(x^4 - 6 x^2) + e] dx\n= 2 [a(1/5 - 2) + e] = 2 (-9a/5 + e),\nso e = 9 a / 5. Comparing with e = 1 + 5 a yields\n1 + 5 a = 9 a / 5 \u21d2 5 + 25 a = 9 a \u21d2 16 a = -5 \u21d2 a = -5/16,\nand then e = -9/16. Hence\nf(x) = (-5/16) x^4 + (30/16) x^2 - 9/16 = (-5 x^4 + 30 x^2 - 9)/16.\n\n3) Computing the minimum value\n\nFor this f,\nf''(x) = 12 a (x^2 - 1) = 12(-5/16)(x^2 - 1) = (15/4)(1 - x^2).\nTherefore\n\u222b_{-1}^{1} (f'')^2 dx\n= (225/16) \u222b_{-1}^{1} (1 - 2 x^2 + x^4) dx\n= (225/16) [2 - 2\u00b7(2/3) + 2/5]\n= (225/16) \u00b7 (16/15) = 15.\n\n4) Optimality and uniqueness\n\nLet f0 be the quartic above, and let h = f - f0. Then h(\u00b11) = 0 and \u222b h = 0. We have\nJ(f) = \u222b (f0'' + h'')^2 = \u222b (f0'')^2 + 2 \u222b f0'' h'' + \u222b (h'')^2.\nIntegrating by parts twice as before, using f0''(\u00b11)=0 and f0^{(4)} constant, we get\n\u222b f0'' h'' = \u222b f0^{(4)} h = const \u00b7 \u222b h = 0.\nHence\nJ(f) = J(f0) + \u222b (h'')^2 \u2265 J(f0) = 15,\nwith equality iff h'' \u2261 0, i.e., h is linear. Since h(\u00b11) = 0, h \u2261 0, so f \u2261 f0. Thus the minimizer is unique.\n\nTherefore,\n\u222b_{-1}^{1} (f''(x))^2 dx \u2265 15,\nwith equality if and only if\nf(x) = (-5 x^4 + 30 x^2 - 9)/16.\n\nFinal answer:\n- The inequality holds: \u222b_{-1}^{1} (f''(x))^2 dx \u2265 15.\n- Equality occurs precisely for f(x) = (-5 x^4 + 30 x^2 - 9)/16.",
      "Define w(x) = 1 \u2212 x^2. For any twice continuously differentiable f with \u222b_{-1}^1 f = 0 and f(\u00b11) = 1, compute\n\u222b_{-1}^1 f''(x) w(x) dx\nby integrating by parts twice:\n\u222b f'' w = [f' w]_{-1}^1 \u2212 \u222b f' w'\n= \u2212[f w']_{-1}^1 + \u222b f w''\n= \u2212(f(1)w'(1) \u2212 f(-1)w'(-1)) + \u222b f (\u22122),\nwhere we used w(\u00b11) = 0 and w'' = \u22122. Since w'(1) = \u22122, w'(\u22121) = 2, f(\u00b11) = 1, and \u222b f = 0, we obtain\n\u222b_{-1}^1 f''(x) (1 \u2212 x^2) dx = \u2212(1\u00b7(\u22122) \u2212 1\u00b72) + (\u22122)\u00b70 = 4.\n\nBy Cauchy\u2013Schwarz,\n(\u222b f'' w)^2 \u2264 \u222b (f'')^2 \u222b w^2,\nhence\n\u222b_{-1}^1 (f'')^2 dx \u2265 (\u222b f'' w)^2 / \u222b w^2 = 16 / \u222b_{-1}^1 (1 \u2212 x^2)^2 dx.\nCompute \u222b_{-1}^1 (1 \u2212 x^2)^2 dx = \u222b (1 \u2212 2x^2 + x^4) dx = 2 \u2212 4/3 + 2/5 = 16/15.\nTherefore,\n\u222b_{-1}^1 (f'')^2 dx \u2265 16 / (16/15) = 15.\n\nEquality holds in Cauchy\u2013Schwarz iff f'' is proportional to w, i.e., f''(x) = c(1 \u2212 x^2). Integrating twice gives\nf(x) = c(x^2/2 \u2212 x^4/12) + \u03b1 x + \u03b2.\nFrom f(\u00b11) = 1 we get \u03b1 = 0 and \u03b2 = 1 \u2212 5c/12. The condition \u222b_{-1}^1 f = 0 yields\nc(3/10) + 2\u03b2 = 0 \u21d2 c = 15/4, hence \u03b2 = \u22129/16.\nThus the equality cases are exactly\nf(x) = \u2212(5/16) x^4 + (15/8) x^2 \u2212 9/16,\nfor which f''(x) = (15/4)(1 \u2212 x^2) and \u222b (f'')^2 = 15.\n\nFinal answer:\n\u222b_{-1}^{1} (f''(x))^2 dx \u2265 15, with equality if and only if f(x) = \u2212(5/16) x^4 + (15/8) x^2 \u2212 9/16.",
      "Let g(x) = 1 - x^2. For any twice continuously differentiable f with f(\u00b11) = 1 and \u222b_{-1}^1 f = 0, integrate by parts twice:\n\n\u222b_{-1}^1 f''(x) g(x) dx\n= [f'(x) g(x)]_{-1}^1 - \u222b_{-1}^1 f'(x) g'(x) dx\n= 0 + 2\u222b_{-1}^1 x f'(x) dx\n= [2x f(x)]_{-1}^1 - 2\u222b_{-1}^1 f(x) dx\n= 2(f(1) + f(-1)) - 2\u222b_{-1}^1 f(x) dx\n= 4.\n\nBy Cauchy\u2013Schwarz,\n(\u222b_{-1}^1 f'' g)^2 \u2264 \u222b_{-1}^1 (f'')^2 \u222b_{-1}^1 g^2,\nso\n\u222b_{-1}^1 (f'')^2 \u2265 16 / \u222b_{-1}^1 (1 - x^2)^2 dx.\n\nCompute \u222b_{-1}^1 (1 - x^2)^2 dx = \u222b_{-1}^1 (1 - 2x^2 + x^4) dx\n= 2(1 - 2/3 + 1/5) = 16/15.\n\nHence \u222b_{-1}^1 (f'')^2 \u2265 16 / (16/15) = 15.\n\nEquality in Cauchy\u2013Schwarz occurs iff f'' is a constant multiple of g, i.e., f''(x) = \u03bb(1 - x^2). Using \u222b f'' g = 4 and \u222b g^2 = 16/15 gives \u03bb = 15/4. Integrating twice,\nf'(x) = (15/4)(x - x^3/3) + A, \nf(x) = (15/8)x^2 - (15/48)x^4 + A x + B.\n\nThe boundary conditions f(1) = f(-1) = 1 force A = 0 and B = -9/16. Thus\nf(x) = - (5/16) x^4 + (15/8) x^2 - 9/16 = (-5 x^4 + 30 x^2 - 9)/16,\nwhich also satisfies \u222b_{-1}^1 f = 0. This function yields \u222b_{-1}^1 (f'')^2 = 15.\n\nTherefore the inequality holds, and equality occurs precisely for f(x) = (-5 x^4 + 30 x^2 - 9)/16.\n\nFinal answer:\n\u222b_{-1}^{1} (f''(x))^2 dx \u2265 15, with equality iff f(x) = (-5 x^4 + 30 x^2 - 9)/16."
    ],
    "variant_times": [
      110.25999808311462,
      73.82513093948364,
      75.9579451084137
    ],
    "final": "Let w(x) = 1 \u2212 x^2. For any twice continuously differentiable f with f(\u00b11) = 1 and \u222b_{-1}^{1} f = 0, integrate by parts twice:\n\u222b_{-1}^{1} f''(x) w(x) dx\n= [f'(x) w(x)]_{-1}^1 \u2212 \u222b_{-1}^{1} f'(x) w'(x) dx\n= 0 + 2\u222b_{-1}^{1} x f'(x) dx\n= [2x f(x)]_{-1}^1 \u2212 2\u222b_{-1}^{1} f(x) dx\n= 2(f(1) + f(-1)) \u2212 2\u00b70\n= 4.\n\nBy Cauchy\u2013Schwarz,\n(\u222b_{-1}^{1} f'' w)^2 \u2264 \u222b_{-1}^{1} (f'')^2 \u222b_{-1}^{1} w^2,\nso\n\u222b_{-1}^{1} (f'')^2 \u2265 16 / \u222b_{-1}^{1} (1 \u2212 x^2)^2 dx.\nSince \u222b_{-1}^{1} (1 \u2212 x^2)^2 dx = \u222b_{-1}^{1} (1 \u2212 2x^2 + x^4) dx = 2 \u2212 4/3 + 2/5 = 16/15, we get\n\u222b_{-1}^{1} (f'')^2 dx \u2265 16 / (16/15) = 15.\n\nEquality in Cauchy\u2013Schwarz holds iff f'' is a constant multiple of w, say f''(x) = \u03bb(1 \u2212 x^2). Then\n4 = \u222b f'' w = \u03bb \u222b w^2 = \u03bb \u00b7 16/15,\nso \u03bb = 15/4. Integrating twice,\nf(x) = \u03bb(x^2/2 \u2212 x^4/12) + Ax + B = \u2212(5/16)x^4 + (15/8)x^2 + Ax + B.\nThe conditions f(1) = f(\u22121) = 1 force A = 0 and B = 1 \u2212 5\u03bb/12 = \u22129/16. This f also satisfies \u222b_{-1}^{1} f = 0. Thus equality occurs exactly for\nf(x) = (\u22125 x^4 + 30 x^2 \u2212 9)/16.\n\nFinal answer:\n\u222b_{-1}^{1} (f''(x))^2 dx \u2265 15, with equality if and only if f(x) = (\u22125 x^4 + 30 x^2 \u2212 9)/16.",
    "final_time": 77.38974404335022,
    "total_problem_time": 337.4328181743622
  },
  {
    "id": "problem_3",
    "round": "Day 1",
    "variants": [
      "Let n = 2025. We first characterize the set S.\n\nClaim. A real symmetric rank-1 matrix with entries in {\u22121, +1} must be of the form\nA = s \u03b5 \u03b5^T, where s \u2208 {\u22121, +1} and \u03b5 \u2208 {\u22121, +1}^n.\n\nProof. Any real symmetric rank-1 matrix has the form A = \u03bb xx^T for some \u03bb \u2260 0 and x \u2208 R^n. Then a_ii = \u03bb x_i^2 \u2208 {\u00b11}. Since x_i^2 \u2265 0 and \u03bb is fixed, the signs of the diagonal entries cannot vary with i; hence all a_ii are equal, say a_ii = s \u2208 {\u00b11} for all i. Thus \u03bb x_i^2 = s is constant, so |x_i| is constant and nonzero. Write x_i = a \u03b5_i with a > 0 and \u03b5_i \u2208 {\u00b11}. Then A_ij = \u03bb x_i x_j = \u03bb a^2 \u03b5_i \u03b5_j = s \u03b5_i \u03b5_j. Hence A = s \u03b5 \u03b5^T. Conversely, any such matrix has rank 1, is symmetric, and has entries in {\u00b11}. This proves the claim.\n\nThus every A \u2208 S can be written as A = s_a u u^T with s_a \u2208 {\u00b11} and u \u2208 {\u00b11}^n, and similarly B = s_b v v^T with s_b \u2208 {\u00b11} and v \u2208 {\u00b11}^n. Note that replacing u by \u2212u (or v by \u2212v) does not change the matrix.\n\nCompute\nAB = s_a s_b u (u^T v) v^T,  BA = s_a s_b v (v^T u) u^T.\nLet c = u^T v = \u2211_{i=1}^n u_i v_i. Then AB = s_as_b c u v^T and BA = s_as_b c v u^T. Therefore AB = BA if and only if either:\n- c = 0, in which case AB = BA = 0; or\n- u v^T = v u^T, which holds if and only if u and v are proportional, i.e., v = \u00b1 u (since u, v have \u00b11 entries).\n\nNow n = 2025 is odd, so c = \u2211 u_i v_i is a sum of an odd number of \u00b11 terms and cannot be zero. Hence the only way AB = BA is when v = \u00b1 u, i.e., when B\u2019s sign-pattern equals A\u2019s up to a global sign. The scalar signs s_a, s_b do not affect commutativity.\n\nCounting/probability. The set S has size |S| = 2^n: there are 2 choices for s and 2^{n-1} choices for the sign-pattern class [u] = {u, \u2212u}. For a fixed A, the commuting B must have the same class [v] = [u], and there are exactly 2 such B (s_b = \u00b11). Thus, for each A, the number of commuting B is 2, out of |S| = 2^n possible B. Therefore\nP(AB = BA) = 2 / 2^n = 2^{1-n} = 2^{-(n-1)}.\n\nWith n = 2025, this is 2^{-2024}.\n\nFinal answer.\n2^{-2024}",
      "Let n=2025. Any real symmetric rank-1 matrix with entries \u00b11 must be of the form\nA = \u03b5 u u^T, where \u03b5 \u2208 {\u00b11} and u \u2208 {\u00b11}^n.\nIndeed, for a symmetric rank-1 A = \u03bb x x^T, the condition that all entries are \u00b11 forces |x_i| to be constant, so x = c s with s_i \u2208 {\u00b11}, and then A = sign(\u03bb) s s^T.\n\nThus choose A = \u03b1 u u^T and B = \u03b2 v v^T with \u03b1,\u03b2 \u2208 {\u00b11} and u,v \u2208 {\u00b11}^n, independently and uniformly (this yields the uniform distribution on S).\n\nCompute\nAB = \u03b1\u03b2 (u^T v) u v^T,  BA = \u03b1\u03b2 (u^T v) v u^T.\nHence AB = BA iff either\n- u^T v = 0, or\n- u v^T = v u^T, which holds iff u and v are linearly dependent, i.e., u = \u00b1 v (since entries are \u00b11).\n\nBecause n = 2025 is odd, u^T v = sum of 2025 terms each \u00b11 cannot be 0. Therefore the only commuting case is u = \u00b1 v.\n\nWith u and v independent uniform in {\u00b11}^n,\nP(u = v) = 2^{-n},  P(u = \u2212v) = 2^{-n},\nso P(u = \u00b1 v) = 2 \u22c5 2^{-n} = 2^{1-n}.\n\nFor n = 2025 this is 2^{-2024}.\n\nFinal answer: 2^{-2024}",
      "Let n = 2025. Any real symmetric rank-1 matrix A can be written as A = \u03bbuu^T for some vector u and scalar \u03bb. If all entries of A are \u00b11, then in particular Aii = \u03bbu_i^2 \u2208 {\u00b11} for all i. Since u_i^2 > 0, all diagonal entries must have the same sign, so u_i^2 is constant across i. Hence |u_i| is constant; writing \u03b5_i = sign(u_i) \u2208 {\u00b11}, we get\nA = s \u03b5 \u03b5^T,\nwhere \u03b5 \u2208 {\u00b11}^n and s \u2208 {\u00b11}. Thus\nS = { s v v^T : v \u2208 {\u00b11}^n, s \u2208 {\u00b11} },\nwith v and \u2212v giving the same matrix for fixed s. Therefore |S| = 2 \u00b7 2^{n-1} = 2^n.\n\nTake A = s_a a a^T and B = s_b b b^T with a,b \u2208 {\u00b11}^n and s_a,s_b \u2208 {\u00b11}. Then\nAB = s_as_b (a^T b) a b^T, and BA = s_as_b (a^T b) b a^T.\nHence AB = BA iff either a^T b = 0 or a b^T = b a^T. The latter holds iff a and b are proportional, and since a,b have \u00b11 entries, that means b = \u00b1 a.\n\nNow, because n = 2025 is odd, the inner product a^T b cannot be 0 (it equals n \u2212 2d for some integer d, hence is odd). Therefore A and B commute iff b = \u00b1 a.\n\nFix A. The matrices B that commute with A are exactly B = \u00b1 a a^T, i.e., 2 choices out of |S| = 2^n. Thus the desired probability is\n2 / 2^n = 2^{1-n} = 2^{-2024}.\n\nFinal answer: 2^{-2024}"
    ],
    "variant_times": [
      131.5177788734436,
      84.7490930557251,
      74.01507377624512
    ],
    "final": "Let n = 2025. We first characterize the set S of real symmetric rank-1 matrices with entries in {\u22121, +1}.\n\nAny real symmetric rank-1 matrix has the form A = \u03bb xx^T with \u03bb \u2260 0. The diagonal entries are A_{ii} = \u03bb x_i^2 \u2208 {\u00b11}. Since x_i^2 \u2265 0 and \u03bb is fixed, all A_{ii} must have the same sign s \u2208 {\u00b11}, so \u03bb x_i^2 = s for all i, implying |x_i| is constant. Write x = a \u03b5 with a > 0 and \u03b5 \u2208 {\u00b11}^n. Then\nA = \u03bb a^2 \u03b5 \u03b5^T, and because \u03bb a^2 = s, we get A = s \u03b5 \u03b5^T.\nConversely, any s \u03b5 \u03b5^T is symmetric, rank 1, and has entries \u00b11. Thus\nS = { s \u03b5 \u03b5^T : s \u2208 {\u00b11}, \u03b5 \u2208 {\u00b11}^n }, with \u03b5 and \u2212\u03b5 yielding the same matrix. Hence |S| = 2 \u00b7 2^{n-1} = 2^n.\n\nLet A = s_a u u^T and B = s_b v v^T with u, v \u2208 {\u00b11}^n and s_a, s_b \u2208 {\u00b11}. Then\nAB = s_a s_b (u^T v) u v^T,  BA = s_a s_b (u^T v) v u^T.\nTherefore AB = BA if and only if either:\n- u^T v = 0, or\n- u v^T = v u^T, which holds if and only if u and v are proportional. Since u, v have entries \u00b11, this means v = \u00b1 u.\n\nBut u^T v is the sum of n = 2025 odd many terms each \u00b11, so it cannot be zero. Thus AB = BA if and only if v = \u00b1 u.\n\nFix A. The B that commute with A are precisely those with the same sign-pattern class [v] = [u], and there are exactly two such matrices (s_b = \u00b11). Since |S| = 2^n, the desired probability is 2 / 2^n = 2^{1-n}.\n\nFor n = 2025, this equals 2^{-2024}.\n\nFinal answer.\n2^{-2024}",
    "final_time": 59.51632285118103,
    "total_problem_time": 349.79826855659485
  },
  {
    "id": "problem_4",
    "round": "Day 1",
    "variants": [
      "Let a be a fixed even positive integer, and let b be any positive integer. Set\nt = floor(x/a), so x = at + r with 0 \u2264 r < a.\n\nRewrite the left-hand side:\nfloor( (b^a + x)^{1/a} b^{a-1} ) = floor( b^a (1 + x/b^a)^{1/a} ).\n\nWe want\nfloor( b^a (1 + x/b^a)^{1/a} ) = b^a + t\nfor all b. This is equivalent to the double inequality\nb^a + t \u2264 b^a (1 + x/b^a)^{1/a} < b^a + t + 1,\nor, after dividing by b^a and raising to the power a (note monotonicity since a is even),\n(1 + t/b^a)^a \u2264 1 + x/b^a < (1 + (t+1)/b^a)^a.\n\nMultiplying by b^a and expanding, this becomes, for all b \u2265 1,\nat + \u2211_{k=2}^a C(a,k) t^k b^{-a(k-1)} \u2264 x < a(t+1) + \u2211_{k=2}^a C(a,k) (t+1)^k b^{-a(k-1)}.\n\nTaking the intersection over all b, the left endpoints increase to their maximum at b=1, while the right endpoints decrease to their minimum as b \u2192 \u221e. Hence the condition is exactly\n(1+t)^a - 1 \u2264 x < a(t+1).      (1)\n\nSince (1+t)^a - 1 \u2265 at for t \u2265 0 (by the binomial theorem), any x in (1) does satisfy floor(x/a) = t, and the above inequalities yield the desired floor identity for all b.\n\nThus, for each integer t \u2265 -1, the admissible x form the interval\n[(1+t)^a - 1, a(t+1)),\nbut this interval is nonempty only when\n(1+t)^a - 1 < a(t+1)  \u21d4  (t+1)^a \u2264 a(t+1).\n\nLet s = t+1 \u2265 0. The condition becomes s^a \u2264 a s. Therefore the solution set is the union, over all integers s \u2265 0 with s^a \u2264 a s, of the intervals\n[s^a - 1, a s).\n\nNow determine which s work:\n\n- s = 0 gives [-1, 0).\n- s = 1 gives [0, a).\n- For s \u2265 2, the condition s^a \u2264 a s is equivalent to s^{a-1} \u2264 a. For even a \u2265 4, we have 2^{a-1} > a, so no s \u2265 2 works. For a = 2, we have s^{a-1} = s \u2264 2, so s = 2 also works, yielding [2^2 - 1, 2\u00b72) = [3, 4).\n\nTherefore:\n- If a = 2, the solutions are x \u2208 [-1, 2) \u222a [3, 4).\n- If a \u2265 4 is even, the solutions are x \u2208 [-1, a).\n\nFinal answer.\n- For a = 2: all real x in [-1, 2) \u222a [3, 4).\n- For even a \u2265 4: all real x in [-1, a).",
      "Let a \u2265 2 be even. Write\nx = ak + r with k = \u23a3x/a\u23a6 and r \u2208 [0, a).\n\nThe equation is\n\u230a b^{a-1} \u221a[a]{b^a + x} \u230b = b^a + \u23a3x/a\u23a6\nfor every positive integer b. Using \u221a[a]{b^a + x} = b(1 + x/b^a)^{1/a}, the left-hand side is\n\u230a b^a (1 + (ak + r)/b^a)^{1/a} \u230b.\n\nThus the equality is equivalent to, for all b \u2208 N,\nb^a + k \u2264 b^a (1 + (ak + r)/b^a)^{1/a} < b^a + k + 1.      (1)\n\nUpper bound.\nFor u \u2265 \u22121 and a \u2265 1, the function t \u21a6 (1 + t)^{1/a} is concave, so\n(1 + u)^{1/a} \u2264 1 + u/a.\nApplying this with u = (ak + r)/b^a yields\nb^a (1 + (ak + r)/b^a)^{1/a} \u2264 b^a + k + r/a < b^a + k + 1\nsince r < a. Hence the right inequality in (1) always holds.\n\nLower bound.\nThe left inequality in (1) is equivalent (by monotonicity of x \u21a6 x^a) to\n1 + (ak + r)/b^a \u2265 (1 + k/b^a)^a,\ni.e.\nr \u2265 \u2211_{i=2}^a C(a,i) k^i / b^{a(i\u22121)}.                    (2)\n\nTherefore the condition for all b is r \u2265 sup_{b\u22651} T_b(k), where\nT_b(k) = \u2211_{i=2}^a C(a,i) k^i / b^{a(i\u22121)}.\n\n- If k \u2265 0, each term is \u2265 0 and decreases with b, so sup_{b\u22651} T_b(k) = T_1(k) = (1 + k)^a \u2212 1 \u2212 a k.\n\n- If k = \u22121, then\nT_b(\u22121) = \u2211_{i=2}^a C(a,i) (\u22121)^i / b^{a(i\u22121)}.\nLet u = 1/b^a \u2208 (0,1]. Define\n\u03a6(u) = ((1 \u2212 u)^a \u2212 1 + a u)/u = \u2211_{i=2}^a C(a,i)(\u22121)^i u^{i\u22121}.\nThen\n\u03a6\u2032(u) = [1 \u2212 (1 \u2212 u)^{a\u22121}(1 + (a \u2212 1)u)]/u^2 \u2265 0,\nbecause g(u) = (1 \u2212 u)^{a\u22121}(1 + (a \u2212 1)u) is decreasing on [0,1] and g(0)=1. Hence \u03a6 is increasing on (0,1], so \u03a6(u) \u2264 \u03a6(1) = a \u2212 1. Therefore sup_{b\u22651} T_b(\u22121) = a \u2212 1.\n\n- If k \u2264 \u22122, one checks directly\n(1 + k)^a \u2212 1 \u2212 a k = (\u22121 \u2212 t)^a \u2212 1 + a(1 + t) with t \u2265 1\nequals t^a \u2212 1 + a + a t \u2265 2a, so it already exceeds a.\n\nThus, a necessary and sufficient condition for (1) is\nr \u2265 F(k) := (1 + k)^a \u2212 1 \u2212 a k, with 0 \u2264 r < a.            (3)\n\nSince r < a, this forces F(k) < a. We now solve F(k) < a for integer k:\n\n- k = 0: F(0) = 0 < a, allowed; r \u2208 [0, a), i.e. x \u2208 [0, a).\n\n- k = \u22121: F(\u22121) = a \u2212 1 < a, allowed; r \u2208 [a \u2212 1, a), i.e. x = \u2212a + r \u2208 [\u22121, 0).\n\n- k = 1: F(1) = 2^a \u2212 1 \u2212 a. This is < a only when a = 2, giving F(1) = 1 < 2. Then r \u2208 [1, 2), i.e. x \u2208 [3, 4). For even a \u2265 4, F(1) \u2265 11 \u2265 a, so k = 1 is not allowed.\n\n- k \u2265 2 or k \u2264 \u22122: F(k) \u2265 2a \u2265 a, not allowed.\n\nConclusion.\n- If a = 2: the solutions are x \u2208 [\u22121, 2) \u222a [3, 4).\n- If a \u2265 4 even: the solutions are x \u2208 [\u22121, a).\n\nFinal answer.\n- For a = 2: all real x in [\u22121, 2) \u222a [3, 4).\n- For even a \u2265 4: all real x in [\u22121, a).",
      "Let a be an even positive integer and let x be real. For the expression to be defined for every positive integer b, we must have b^a + x \u2265 0 for b = 1, hence x \u2265 -1.\n\nRewrite the left-hand side:\nsqrt[a]{b^a + x} \u00b7 b^{a-1} = b^a (1 + x/b^a)^{1/a}.\nTherefore the equality is equivalent to\nfloor( b^a (1 + x/b^a)^{1/a} ) = b^a + floor(x/a).\nSubtract b^a from both sides (noting b^a is an integer):\nfloor( b^a((1 + x/b^a)^{1/a} - 1) ) = floor(x/a).  (1)\n\nDefine\nF_b(x) = b^a((1 + x/b^a)^{1/a} - 1).\nBy concavity of t \u21a6 t^{1/a} on (0,\u221e) (since 1/a \u2208 (0,1]), we have for y \u2265 -1:\n(1 + y)^{1/a} \u2264 1 + y/a,\nso F_b(x) \u2264 x/a. Thus floor(F_b(x)) \u2264 floor(x/a). To obtain equality in (1), it suffices to ensure F_b(x) \u2265 floor(x/a) for all b.\n\nMonotonicity in b. Write\nF_b(x) = x \u00b7 H(1 + x/b^a), where H(s) = (s^{1/a} - 1)/(s - 1) for s > 0, s \u2260 1, and H(1) = 1/a.\nSince t \u21a6 t^{1/a} is concave, the chord slope H(s) is decreasing in s on (0,\u221e). As b increases, 1 + x/b^a moves monotonically to 1, and from the monotonicity of H we get that F_b(x) is increasing in b (for both signs of x). Hence\nmin_{b\u22651} F_b(x) = F_1(x) = (1 + x)^{1/a} - 1,\nand F_b(x) \u2264 x/a for all b.\n\nTherefore, (1) holds for all b if and only if\n(1 + x)^{1/a} - 1 \u2265 floor(x/a), with x \u2265 -1.  (2)\n\nLet k = floor(x/a), so x \u2208 [ak, ak + a). We analyze (2) by cases.\n\n- If k \u2264 -1: then 1 + k \u2264 0 and since (1 + x)^{1/a} \u2265 0, the inequality in (2) holds automatically. Intersecting with x \u2265 -1 forces k = -1 and x \u2208 [-1, 0).\n\n- If k \u2265 0: then (2) is equivalent to (1 + x)^{1/a} \u2265 1 + k, i.e.\nx \u2265 (1 + k)^a - 1,\ntogether with x \u2208 [ak, ak + a). Thus we need the interval\n[(1 + k)^a - 1, ak + a)\nto be nonempty.\n\nFor k = 0, this gives x \u2208 [0, a).\n\nFor k \u2265 1, note that\n(1 + k)^a - 1 = ak + C, where C = sum_{j=2}^a binom(a,j) k^j \u2265 binom(a,2) k^2.\nHence for k \u2265 1:\n(1 + k)^a - 1 \u2265 ak + binom(a,2) \u2265 ak + a if a \u2265 4,\nso the interval is empty for all k \u2265 1 when a \u2265 4.\n\nFor a = 2, the condition becomes (1 + k)^2 - 1 < 2(k + 1), i.e. k^2 < 2, so k = 0 or k = 1. We already have k = 0 giving [0, 2); for k = 1 we get x \u2208 [3, 4).\n\nCollecting all cases:\n- If a = 2: x \u2208 [-1, 2) \u222a [3, 4).\n- If a \u2265 4 even: x \u2208 [-1, a).\n\nIt is straightforward to check that these x indeed satisfy the original identity for all b, using the monotonicity of F_b(x) and the bounds F_b(x) \u2208 [F_1(x), x/a).\n\nFinal answer.\n- For a = 2: all real x in [-1, 2) \u222a [3, 4).\n- For even a \u2265 4: all real x in [-1, a)."
    ],
    "variant_times": [
      240.45443296432495,
      314.7528781890869,
      222.75086164474487
    ],
    "final": "Let a be a fixed even positive integer and b a positive integer. Write x = ak + r with k = \u230ax/a\u230b and 0 \u2264 r < a. Note first that b^a + x \u2265 0 for b = 1 forces x \u2265 \u22121.\n\nWe have\n\u230ab^{a-1}(b^a + x)^{1/a}\u230b = \u230ab^a(1 + x/b^a)^{1/a}\u230b = b^a + k\nif and only if, for all b \u2208 N,\nb^a + k \u2264 b^a(1 + (ak + r)/b^a)^{1/a} < b^a + k + 1.   (1)\n\nUpper bound. Since t \u21a6 (1 + t)^{1/a} is concave on [\u22121, \u221e),\n(1 + u)^{1/a} \u2264 1 + u/a (u \u2265 \u22121).\nWith u = (ak + r)/b^a we get\nb^a(1 + u)^{1/a} \u2264 b^a + k + r/a < b^a + k + 1,\nso the right inequality in (1) always holds.\n\nLower bound. The left inequality in (1) is equivalent to\n1 + (ak + r)/b^a \u2265 (1 + k/b^a)^a\n\u21d4 r \u2265 \u2211_{i=2}^a C(a,i) k^i b^{-a(i\u22121)} =: T_b(k).          (2)\n\nThus (1) holds for all b iff r \u2265 sup_{b\u22651} T_b(k). We evaluate this supremum by cases.\n\n- k \u2265 0. All terms in T_b(k) are \u2265 0 and decrease with b, hence\nsup_{b\u22651} T_b(k) = T_1(k) = (1 + k)^a \u2212 1 \u2212 a k =: F(k).\nSo we need r \u2265 F(k) with 0 \u2264 r < a, i.e. F(k) < a. Since F is increasing on k \u2265 0,\nF(0) = 0 and F(1) = 2^a \u2212 1 \u2212 a. For a = 2, F(1) = 1 < 2, while for even a \u2265 4, F(1) \u2265 11 \u2265 a. Hence:\n\u2022 k = 0 is always allowed (r \u2208 [0, a) \u21d2 x \u2208 [0, a));\n\u2022 k = 1 is allowed only if a = 2 (then r \u2208 [1, 2) \u21d2 x \u2208 [3, 4));\n\u2022 k \u2265 2 is never allowed (F(k) \u2265 F(1) \u2265 a).\n\n- k = \u22121. Here\nT_b(\u22121) = \u2211_{i=2}^a C(a,i)(\u22121)^i b^{-a(i\u22121)}.\nLet u = 1/b^a \u2208 (0, 1], and define\n\u03a6(u) = [(1 \u2212 u)^a \u2212 1 + a u]/u = \u2211_{i=2}^a C(a,i)(\u22121)^i u^{i\u22121} = T_b(\u22121).\nCompute\n\u03a6\u2032(u) = [1 \u2212 (1 \u2212 u)^{a\u22121}(1 + (a \u2212 1)u)]/u^2 \u2265 0\nsince (1 \u2212 u)^{a\u22121}(1 + (a \u2212 1)u) decreases on [0,1]. Thus \u03a6 is increasing, so\nsup_{b\u22651} T_b(\u22121) = \u03a6(1) = a \u2212 1.\nTherefore r \u2265 a \u2212 1, i.e. r \u2208 [a \u2212 1, a), giving x \u2208 [\u22121, 0).\n\n- k \u2264 \u22122. Then T_1(k) = (1 + k)^a \u2212 1 \u2212 a k \u2265 2a \u2265 a (since a is even), which cannot be \u2264 r < a. Hence no solutions.\n\nCollecting all possibilities:\n- For any even a \u2265 2: x \u2208 [\u22121, 0) (from k = \u22121) and x \u2208 [0, a) (from k = 0).\n- Additionally, when a = 2: x \u2208 [3, 4) (from k = 1).\n\nIt remains to note that for these x the lower bound r \u2265 sup_b T_b(k) ensures the left inequality in (1), and the concavity estimate ensures the right inequality; hence the original floor identity holds for every b.\n\nFinal answer.\n- If a = 2: all real x in [\u22121, 2) \u222a [3, 4).\n- If a \u2265 4 is even: all real x in [\u22121, a).",
    "final_time": 187.75123000144958,
    "total_problem_time": 965.7094027996063
  },
  {
    "id": "problem_5",
    "round": "Day 1",
    "variants": [
      "Step 1. The eventual shape of a self-map and the exact value of ord(\u03c4).\n\nLet \u03c4 \u2208 T_n. Its functional digraph is a disjoint union of directed cycles, with rooted in-trees feeding into the cycle vertices. Let:\n- c = number of vertices that lie on cycles,\n- h = maximal distance (height) from a vertex to its cycle,\n- \u2113_1, \u2026, \u2113_r be the lengths of the cycles, and L = lcm(\u2113_1, \u2026, \u2113_r).\n\nThen the sequence of maps \u03c4, \u03c4^2, \u2026 is eventually periodic with preperiod length h and period L, and in fact\nord(\u03c4) = h + L.\n\nProof of ord(\u03c4) = h + L:\n- For 0 \u2264 k < h, the maps \u03c4^k are all distinct, since for each k there exists a vertex at depth \u2265 k + 1 whose image under \u03c4^k is still in the tree, whereas \u03c4^{k+1} pushes it one step further.\n- For h \u2264 k < h + L, the maps \u03c4^k are all distinct and \u03c4^{k+L} = \u03c4^k, because once all points have reached their cycles, the action depends on k modulo L.\n- No \u03c4^k with k < h equals any \u03c4^m with m \u2265 h, since the image of a vertex of maximum depth under \u03c4^k is not on a cycle, while under \u03c4^m it is on a cycle.\n\nThus ord(\u03c4) = h + L.\n\nStep 2. A reduction: an exact formula for g(n).\n\nFrom Step 1, for any \u03c4 we have ord(\u03c4) = h + L, where L is the lcm of cycle lengths (over the c cycle vertices), and h \u2264 n \u2212 c. For fixed c, the maximal possible L among permutations on c letters is f(c). Hence\nord(\u03c4) \u2264 (n \u2212 c) + f(c).\n\nConversely, this bound is attained: choose a permutation on c with order f(c), and let the remaining t = n \u2212 c vertices form a single directed path feeding into one vertex on some cycle. Then h = t and L = f(c), so ord(\u03c4) = t + f(c).\n\nTherefore\ng(n) = max_{0 \u2264 t \u2264 n} [t + f(n \u2212 t)].\n\nStep 3. A number-theoretic lemma.\n\nWe prove that for sufficiently large n, and for any integer s with s \u2265 n^{0.501},\nf(n) \u2212 f(n \u2212 s) \u2265 s \u2212 n^{0.501} \u2212 1.   (\u22c6)\n\nProof. Let c = n \u2212 s, and let L* = f(c), realized by some permutation on c points. Let u = \u2308n^{0.501}\u2309 and consider the set P of primes in the interval (s \u2212 u, s]. A standard consequence of the prime number theorem (via partial summation) is that the sum S(x) of primes \u2264 x satisfies S(x) \u223c x^2/(2 log x). In particular, there exists a constant K > 0 such that for all sufficiently large x and all 1 \u2264 y \u2264 x,\n\u2211_{x\u2212y < p \u2264 x} p \u2265 K x y / log x.\n\nApplying this with x = s and y = u, for large n we get\n\u2211_{p \u2208 P} p \u2265 K s u / log s \u226b n^{1.002}/log n > n \u2265 c.\n\nNow, if every prime p \u2208 P divides L*, then in the permutation of size c we would need to include each such prime as a factor of some cycle length. Covering a prime p requires at least p points in the cycles (because some cycle length must be a multiple of p, hence \u2265 p). Covering several primes with a single cycle does not reduce this cost (a multiple of distinct primes p and q has length at least pq \u2265 p + q). Therefore the total number of cycle vertices needed to include all primes in P is at least \u2211_{p \u2208 P} p, which exceeds c for large n. This is impossible. Hence there exists a prime m \u2208 P that does not divide L*.\n\nUsing the remaining s points, form one additional cycle of length m (and make the other s \u2212 m points fixed). Then on n points we obtain a permutation whose order is lcm(L*, m) = L*\u00b7m (because gcd(L*, m) = 1). Thus\nf(n) \u2265 L*\u00b7m \u2265 L* + m \u2212 1 \u2265 f(n \u2212 s) + (s \u2212 u) \u2212 1,\nsince m \u2265 s \u2212 u and L* \u2265 1, which proves (\u22c6).\n\nStep 4. Conclusion.\n\nRecall g(n) = max_{0 \u2264 t \u2264 n} [t + f(n \u2212 t)].\n- If t \u2264 n^{0.501}, then t + f(n \u2212 t) \u2264 f(n) + n^{0.501}.\n- If t \u2265 n^{0.501}, apply (\u22c6) with s = t to get\nf(n \u2212 t) \u2264 f(n) \u2212 (t \u2212 n^{0.501} \u2212 1),\nso t + f(n \u2212 t) \u2264 f(n) + n^{0.501} + 1.\n\nTherefore, for sufficiently large n,\ng(n) \u2264 f(n) + \u230an^{0.501}\u230b + 1 < f(n) + n^{0.501}.\n\nThis proves the desired inequality.\n\nFinal answer.\nFor sufficiently large n,\ng(n) < f(n) + n^{0.501}.",
      "Let \u03c4 \u2208 T_n. View \u03c4 as a functional digraph on [n], i.e., a disjoint union of directed cycles with rooted trees feeding into those cycles.\n\nWrite:\n- C = set of cyclic points of \u03c4, m = |C|.\n- t = n \u2212 m = number of non-cyclic points.\n- L = lcm of the cycle lengths on C (so L is the order of the restriction of \u03c4 to C). In particular L \u2264 f(m).\n- h = maximum distance (height) of a non-cyclic point to its eventual cycle. Then h \u2264 t.\n\nTwo basic facts about the iterates \u03c4^k:\n1) After h steps, every point has reached a cycle, so from that time on the restriction to C is a permutation of C with period L. Hence the sequence of maps \u03c4, \u03c4^2, \u2026 becomes periodic after at most h steps with period dividing L.\n2) Therefore the number of distinct maps among {\u03c4, \u03c4^2, \u03c4^3, \u2026} is at most h + L.\n\nThus\nord(\u03c4) \u2264 h + L \u2264 t + f(m).  (1)\n\nWe will compare f(m) with f(n) using a simple prime-counting argument.\n\nA prime in (t/2, t] cannot appear together with a distinct prime in the same cycle length (for large n) because the product of two distinct primes p, q > t/2 is > t^2/4, which exceeds m for t \u2265 n^0.501 and all sufficiently large n (since then t^2/4 \u2265 n^1.002/4 > n \u2265 m). Hence, each distinct prime p \u2208 (t/2, t] dividing the order L must be supported by a different cycle of length at least p \u2265 t/2, consuming at least t/2 points. Therefore, the number r of primes in (t/2, t] dividing L satisfies\nr \u2264 2m/t \u2264 2n/t.  (2)\n\nOn the other hand, by standard prime number estimates, for all sufficiently large x,\n\u03c0(x) \u2212 \u03c0(x/2) \u2265 c x / log x\nfor some absolute constant c > 0. Taking x = t (and recalling t \u2265 n^0.501), we get\n\u03c0(t) \u2212 \u03c0(t/2) \u226b t / log t.\nFor large n this quantity exceeds 2n/t (because t/log t \u226b n^0.501 / log n \u226b n^0.499), so by (2) there exists a prime p \u2208 (t/2, t] that does not divide L.\n\nNow extend any permutation on m points of order f(m) to a permutation on n points by using the remaining t points to form one p-cycle. Since p \u2224 f(m), the new order is lcm(f(m), p) = p f(m). Hence\nf(n) \u2265 p f(m) \u2265 (t/2) f(m),\nso\nf(m) \u2264 2 f(n) / t.  (3)\n\nCombining (1) and (3), we obtain for t \u2265 n^0.501 (and hence t \u2265 2 for large n),\nord(\u03c4) \u2264 t + f(m) \u2264 t + 2 f(n)/t \u2264 t + f(n) \u2264 f(n) + n^0.501.\n\nIf instead t < n^0.501, then from (1) and monotonicity f(m) \u2264 f(n),\nord(\u03c4) \u2264 t + f(m) \u2264 f(n) + t < f(n) + n^0.501.\n\nIn either case, for sufficiently large n,\nord(\u03c4) < f(n) + n^0.501.\n\nTaking the maximum over \u03c4 \u2208 T_n yields\ng(n) < f(n) + n^0.501\nfor all sufficiently large n.\n\nFinal answer.\nFor all sufficiently large n, g(n) < f(n) + n^{0.501}.",
      "Let [n] = {1,2,\u2026,n}. For a self-map \u03c4 on [n], its functional digraph decomposes into directed cycles with rooted trees feeding into the cycles. Denote\n\n- C(\u03c4) the set of cyclic points, m = |C(\u03c4)|.\n- h(\u03c4) the maximal distance (height) from a point to the cycles (i.e., the longest tail length).\n- L(\u03c4) the least common multiple of the cycle-lengths of \u03c4 (i.e., the order of \u03c4 restricted to C(\u03c4), which is a permutation).\n\n1) The number of distinct iterates of a map\n\nClaim. For any \u03c4 \u2208 T_n,\nord(\u03c4) = L(\u03c4) + max(0, h(\u03c4) \u2212 1).\n\nProof. Consider the sequence \u03c4, \u03c4^2, \u03c4^3, \u2026. For k \u2265 h := h(\u03c4), every point is on some cycle after applying \u03c4^k, hence \u03c4^k restricted to C(\u03c4) is a power of the corresponding permutation, and \u03c4^k depends only on k modulo L := L(\u03c4). Thus among k \u2265 h there are exactly L distinct maps: \u03c4^h, \u03c4^{h+1}, \u2026, \u03c4^{h+L\u22121}, and thereafter they repeat with period L.\n\nFor 1 \u2264 k \u2264 h \u2212 1, these maps are all distinct and none coincides with any \u03c4^{h+r}. Indeed, pick x at maximal distance h from the cycles; then \u03c4^k(x) has distance h \u2212 k \u2265 1 from the cycles, whereas for any r \u2265 0, \u03c4^{h+r}(x) lies on a cycle. Hence \u03c4^k \u2260 \u03c4^{h+r}. Therefore the total number of distinct maps is (h \u2212 1) + L if h \u2265 1, and L if h = 0. This is exactly L + max(0, h \u2212 1). \u220e\n\n2) A formula for g(n)\n\nIf \u03c4 has m cyclic points, then h(\u03c4) \u2264 n \u2212 m. By the claim,\nord(\u03c4) \u2264 L(\u03c4) + max(0, n \u2212 m \u2212 1) \u2264 f(m) + max(0, n \u2212 m \u2212 1).\n\nConversely, for any m between 0 and n, choose a permutation \u03c3 \u2208 S_m of order f(m) on some m-element subset C, and attach to one chosen cycle-vertex a directed chain of length n \u2212 m using the other n \u2212 m points. The resulting map \u03c4 has L(\u03c4) = f(m) and h(\u03c4) = n \u2212 m, hence ord(\u03c4) = f(m) + max(0, n \u2212 m \u2212 1).\n\nTherefore\ng(n) = max_{0 \u2264 m \u2264 n} [ f(m) + max(0, n \u2212 m \u2212 1) ].\n\n3) Bounding g(n) in terms of f(n)\n\nLet t = \u230an^{0.501}\u230b.\n\n- If m \u2265 n \u2212 t, then f(m) + max(0, n \u2212 m \u2212 1) \u2264 f(n) + t \u2264 f(n) + n^{0.501}.\n\n- If m \u2264 n \u2212 t \u2212 1, we will show that for all sufficiently large n,\nf(m) + (n \u2212 m \u2212 1) \u2264 f(n).\n\nIt is a classical result (Landau) that\nlog f(k) = (1 + o(1)) \u221a(k log k).\nIn particular, for any \u03b1 > 1/2 we have f(n \u2212 n^\u03b1) = o(f(n)) as n \u2192 \u221e. Taking \u03b1 = 0.501, there exists N1 such that for n \u2265 N1,\nf(n \u2212 t) \u2264 1/2 f(n).\nAlso, since f(n) grows super-polynomially, there exists N2 such that for n \u2265 N2, f(n) \u2265 2n. For m \u2264 n \u2212 t we then have\nf(m) + (n \u2212 m \u2212 1) \u2264 f(n \u2212 t) + n \u2264 (1/2) f(n) + (1/2) f(n) = f(n).\n\nCombining both cases, for n \u2265 max(N1, N2),\ng(n) \u2264 max{ f(n), f(n) + t } = f(n) + t \u2264 f(n) + n^{0.501}.\n\nSince g(n) is an integer, we in fact have\ng(n) \u2264 f(n) + \u230an^{0.501}\u230b < f(n) + n^{0.501}.\n\nThis proves the desired inequality for all sufficiently large n.\n\nFinal answer.\nFor sufficiently large n, g(n) < f(n) + n^{0.501}."
    ],
    "variant_times": [
      588.5985860824585,
      390.10953307151794,
      1036.1972982883453
    ],
    "final": "Solution.\n\n1) Dynamics of a self-map and ord(\u03c4)\n\nLet \u03c4 \u2208 T_n. Its functional digraph is a disjoint union of directed cycles with rooted trees feeding into the cycles. Let:\n- L(\u03c4) be the least common multiple of the cycle lengths;\n- h(\u03c4) be the maximal distance (height) from a vertex to its eventual cycle (i.e., the longest tail length).\n\nClaim. For any \u03c4 \u2208 T_n,\nord(\u03c4) = L(\u03c4) + max(0, h(\u03c4) \u2212 1).\n\nProof. For k \u2265 h := h(\u03c4), every point lies on a cycle after applying \u03c4^k, so \u03c4^k depends only on k modulo L := L(\u03c4). Hence among {\u03c4^h, \u03c4^{h+1}, \u2026} there are exactly L distinct maps. For 1 \u2264 k \u2264 h \u2212 1, the maps \u03c4, \u03c4^2, \u2026, \u03c4^{h\u22121} are pairwise distinct and none coincides with any \u03c4^{h+r} (r \u2265 0): if x is a vertex at maximal distance h from the cycles, then \u03c4^k(x) is not yet on a cycle for k \u2264 h \u2212 1, whereas \u03c4^{h+r}(x) is on a cycle. Summing gives ord(\u03c4) = L + max(0, h \u2212 1). \u220e\n\n2) A formula for g(n)\n\nLet m be the number of cyclic points of \u03c4, so h(\u03c4) \u2264 n \u2212 m, and L(\u03c4) \u2264 f(m). By the claim,\nord(\u03c4) \u2264 f(m) + max(0, n \u2212 m \u2212 1).\n\nConversely, for each m \u2208 {1, \u2026, n}, choose a permutation on an m-element set with order f(m), and attach a directed chain of length n \u2212 m feeding into one point on a cycle. This has L(\u03c4) = f(m) and h(\u03c4) = n \u2212 m, hence ord(\u03c4) = f(m) + max(0, n \u2212 m \u2212 1). Therefore\ng(n) = max_{1 \u2264 m \u2264 n} [ f(m) + max(0, n \u2212 m \u2212 1) ].\n\n3) Bounding g(n) in terms of f(n)\n\nLet t = \u230an^{0.501}\u230b. Split the maximization into two ranges of m.\n\n- If m \u2265 n \u2212 t, then\nf(m) + max(0, n \u2212 m \u2212 1) \u2264 f(n) + t \u2212 1 \u2264 f(n) + t.\n\n- If m \u2264 n \u2212 t \u2212 1, write d = n \u2212 m \u2265 t + 1. We use Landau\u2019s classical asymptotic for the maximal order of a permutation:\nlog f(k) = (1 + o(1)) \u221a(k log k) as k \u2192 \u221e.\nIn particular, for any \u03b1 > 1/2 we have f(n \u2212 n^\u03b1) = o(f(n)). Taking \u03b1 = 0.501, there exists N1 such that for n \u2265 N1,\nf(n \u2212 t) \u2264 1/2 f(n).\nMoreover, f(n) grows super-polynomially, so there exists N2 such that for n \u2265 N2, f(n) \u2265 2n. Hence for n \u2265 max(N1, N2) and all m \u2264 n \u2212 t we have\nf(m) + (n \u2212 m \u2212 1) \u2264 f(n \u2212 t) + n \u2264 (1/2) f(n) + (1/2) f(n) = f(n).\n\nCombining the two cases, for all sufficiently large n,\ng(n) \u2264 f(n) + t < f(n) + n^{0.501}.\n\nFinal answer.\nFor sufficiently large n, g(n) < f(n) + n^{0.501}.",
    "final_time": 507.3716297149658,
    "total_problem_time": 2522.2770471572876
  },
  {
    "id": "problem_6",
    "round": "Day 2",
    "variants": [
      "Define the function\n\u03c6(x) = (f(x) \u2212 k)/x, for x \u2208 [a,b].\n\nSince a,b > 0 and f is continuously differentiable on (0,\u221e), \u03c6 is continuous on [a,b] and differentiable on (a,b). Also, using f(a) = f(b) = k, we have \u03c6(a) = \u03c6(b) = 0. By Rolle\u2019s theorem, there exists \u03be \u2208 (a,b) such that \u03c6\u2032(\u03be) = 0.\n\nCompute the derivative:\n\u03c6\u2032(x) = [x f\u2032(x) \u2212 (f(x) \u2212 k)] / x^2.\n\nThus \u03c6\u2032(\u03be) = 0 implies\nx f\u2032(\u03be) \u2212 (f(\u03be) \u2212 k) = 0,\ni.e.\nf(\u03be) \u2212 \u03be f\u2032(\u03be) = k.\n\nThis proves the claim.\n\nFinal answer:\nThere exists \u03be \u2208 (a,b) such that f(\u03be) \u2212 \u03be f\u2032(\u03be) = k.",
      "Define the function\ng(x) = (f(x) - k)/x, for x \u2208 [a,b].\n\nSince a, b > 0 and f is continuously differentiable on (0, \u221e), the function g is continuous on [a,b] and differentiable on (a,b). Moreover,\ng(a) = (f(a) - k)/a = 0 and g(b) = (f(b) - k)/b = 0.\n\nBy Rolle\u2019s theorem, there exists \u03be \u2208 (a,b) such that g\u2032(\u03be) = 0. Compute\ng\u2032(x) = [x f\u2032(x) - (f(x) - k)] / x^2.\n\nThus g\u2032(\u03be) = 0 implies x f\u2032(\u03be) - (f(\u03be) - k) = 0 at x = \u03be, i.e.,\nf(\u03be) - \u03be f\u2032(\u03be) = k.\n\nFinal answer: There exists \u03be \u2208 (a,b) with f(\u03be) \u2212 \u03be f\u2032(\u03be) = k.",
      "Define g(x) = (f(x) - k)/x on [a,b]. This is well-defined since a,b > 0, continuous on [a,b], and differentiable on (a,b) because f is continuously differentiable.\n\nGiven f(a) = f(b) = k, we have g(a) = g(b) = 0. By Rolle\u2019s theorem, there exists \u03be \u2208 (a,b) such that g\u2032(\u03be) = 0.\n\nCompute\ng\u2032(x) = [x f\u2032(x) - (f(x) - k)]/x^2.\nThus g\u2032(\u03be) = 0 implies x f\u2032(\u03be) - f(\u03be) + k = 0, i.e.,\nf(\u03be) - \u03be f\u2032(\u03be) = k.\n\nFinal answer: There exists \u03be \u2208 (a,b) with f(\u03be) \u2212 \u03be f\u2032(\u03be) = k."
    ],
    "variant_times": [
      17.022743701934814,
      18.438440084457397,
      21.073845863342285
    ],
    "final": "Define g(x) = (f(x) \u2212 k)/x for x \u2208 [a,b]. Since a,b > 0 and f is continuously differentiable on (0,\u221e), g is continuous on [a,b] and differentiable on (a,b). Using f(a) = f(b) = k, we have g(a) = g(b) = 0. By Rolle\u2019s theorem, there exists \u03be \u2208 (a,b) such that g\u2032(\u03be) = 0.\n\nCompute\ng\u2032(x) = [x f\u2032(x) \u2212 (f(x) \u2212 k)]/x^2.\nThus g\u2032(\u03be) = 0 implies\n\u03be f\u2032(\u03be) \u2212 (f(\u03be) \u2212 k) = 0,\ni.e.,\nf(\u03be) \u2212 \u03be f\u2032(\u03be) = k.\n\nFinal answer: There exists \u03be \u2208 (a,b) such that f(\u03be) \u2212 \u03be f\u2032(\u03be) = k.",
    "final_time": 12.632327318191528,
    "total_problem_time": 69.16735696792603
  },
  {
    "id": "problem_7",
    "round": "Day 2",
    "variants": [
      "Write v2(n) for the exponent of 2 in n, and odd(n) = n/2^{v2(n)} for the odd part of n.\n\nWe claim that the sets\nM_d = { n \u2208 Z_{>0} : d divides odd(n) }  for odd d \u2265 1\nare precisely the nonempty subsets M \u2286 Z_{>0} satisfying (a) and (b).\n\nFirst, each M_d satisfies (a) and (b):\n- (a) If d | odd(x), then d | odd(2x) because doubling does not change the odd part.\n- (b) Let x = 2^a d u, y = 2^b d v with u, v odd. If x and y have the same parity, then (x+y)/2 = 2^{min(a,b)-1} d (u 2^{a-min} + v 2^{b-min}). Thus odd((x+y)/2) = d \u00b7 odd(u 2^{a-min} + v 2^{b-min}), so d divides the odd part; hence (x+y)/2 \u2208 M_d.\n\nSo each M_d is a valid solution.\n\nConversely, let M be a nonempty subset satisfying (a) and (b). We prove M = M_d for a suitable odd d.\n\n1) M contains odd numbers. Let t be the minimal v2 among elements of M, and pick x \u2208 M with v2(x) = t. If t = 0, we are done. If t \u2265 1, then x and 2x are both in M and even, so (x+2x)/2 = 3x/2 \u2208 M and v2(3x/2) = t\u22121. Iterating reduces v2 until we obtain an odd element of M.\n\nLet d be the smallest odd element of M.\n\n2) From d we can generate all odd multiples of d. Let O be the set of odd numbers in M. We show by induction on odd m \u2265 1 that d m \u2208 O:\n- Base: m = 1 gives d \u2208 O.\n- Step: Write m = 1 + 2^t m' with m' odd and m' < m. By induction, d m' \u2208 O. Using (a), 2d, 2^{t+1} d m' \u2208 M. They are even, so by (b),\n(2d + 2^{t+1} d m')/2 = d + 2^t d m' = d m \u2208 M,\nand since it is odd, d m \u2208 O.\n\nThus O contains all odd multiples of d. Using (a), M contains all 2^k times these, i.e. M \u2287 M_d.\n\n3) No element outside M_d can lie in M. Suppose x \u2208 M with odd(x) not divisible by d. Let u = odd(x), and let k = v2(x). As in step 1\u2019s reduction trick but \u201cshifted\u201d by d, define a sequence\ns_0 = x, and for j = 0,1,\u2026,k set s_{j+1} = (s_j + 2^{k-j+1} d)/2.\nA direct computation shows s_{j+1} = 2^{k-j-1} (u + 2^{j+1} d), hence s_k = u + 2k d, which is an odd element of M. In particular, M contains an odd element w \u2261 u mod d, hence w is not divisible by d.\n\nNow consider the odd sum d + w. Let t = v2(d + w) \u2265 1 (since both are odd). By repeatedly applying (b) to suitable even multiples (which is allowed by (a)), we can divide out all 2\u2019s from d + w and obtain the odd number\nr = (d + w)/2^t \u2208 M.\nNote that gcd(d, w) = gcd(d, r), and since d \u2224 w, we have gcd(d, w) < d, hence r < d. This contradicts the minimality of d in the set of odd elements of M.\n\nTherefore every x \u2208 M must satisfy d | odd(x), i.e. M \u2286 M_d.\n\nCombining 2) and 3), we get M = M_d.\n\nConclusion. The nonempty subsets M \u2286 Z_{>0} that satisfy (a) and (b) are exactly the sets\nM_d = { n \u2208 Z_{>0} : d divides the odd part of n }  for some odd integer d \u2265 1.\n\nFinal answer.\nFor each odd d \u2265 1, the set M_d = { n \u2208 Z_{>0} : d | odd(n) } is a solution, and these are all the solutions.",
      "Let M \u2286 Z>0 be nonempty and satisfy:\n(a) x \u2208 M \u21d2 2x \u2208 M.\n(b) If x,y \u2208 M and x+y is even, then (x+y)/2 \u2208 M.\n\nStep 1. M is closed under addition.\nIndeed, for any a,b \u2208 M, we have 2a,2b \u2208 M by (a). Then 2a+2b is even and\n(2a+2b)/2 = a+b \u2208 M by (b).\n\nStep 2. M contains an odd element.\nLet t = min{v2(x) : x \u2208 M}, where v2 is the 2-adic valuation. If t \u2265 1, pick x \u2208 M with v2(x)=t. Then 2x \u2208 M and x+2x is even, so (x+2x)/2 = 3x/2 \u2208 M by (b). But v2(3x/2) = t\u22121, contradicting the minimality of t. Hence t=0, so M contains an odd element.\n\nLet r be the least odd element of M.\n\nStep 3. rZ>0 \u2286 M.\nBy Step 1, M is closed under addition; hence all multiples nr (n \u2208 Z>0) lie in M.\n\nStep 4. Every element of M is a multiple of r.\nSuppose, toward a contradiction, that there exists y \u2208 M not divisible by r. By Step 2 we may assume y is odd (if y is even, combine it with sufficiently large powers of 2 times r using (b) to reduce its 2-adic valuation until an odd element is obtained; membership in M is preserved at each step).\n\nWrite y = qr + a with 0 < a < r and a even (since y and r are odd).\n\nDefine a sequence (y0, y1, y2, \u2026) in M by y0 := y and, for n \u2265 0,\nyn+1 := (yn + r)/2 if yn is odd, and yn+1 := (yn + 2r)/2 if yn is even.\nEach step is valid by (b) (pairing yn with r when yn is odd, and with 2r when yn is even).\n\nA simple induction shows that\nyn \u2261 2^(-n) y (mod r),\nwhere 2^(-n) is the inverse of 2^n modulo r (valid since r is odd). In particular, none of the residues yn (mod r) is 0, because y is not divisible by r. Moreover, for n large enough, yn < 2r (since each step roughly halves the current term, up to an additive O(r)). Once yn < 2r, its residue modulo r equals either yn (if yn < r) or yn \u2212 r (if yn > r).\n\nBecause the residue yn (mod r) never vanishes and takes only values in {1,2,\u2026,r\u22121}, eventually some ym is odd and less than r (this uses that the orbit under division by 2 modulo r contains both even and odd residues, and the sequence comes below 2r). But then ym is an odd element of M strictly smaller than r, contradicting the minimality of r.\n\nTherefore no such y exists; every element of M is divisible by r. Hence M \u2286 rZ>0.\n\nCombining with Step 3 we conclude M = rZ>0.\n\nStep 5. Verification.\nFor any odd r, the set M = rZ>0 satisfies (a) and (b): doubling preserves multiples of r, and if x = ra, y = rb have the same parity, then (x+y)/2 = r(a+b)/2 is a multiple of r because a and b have the same parity.\n\nTherefore, the complete list of solutions is exactly the sets of all positive multiples of an odd integer.\n\nFinal answer.\nAll such subsets are M = r Z>0 for some odd integer r \u2265 1.",
      "Let v2(n) be the exponent of 2 in n, and write n = 2^{v2(n)}\u00b7nodd with nodd odd.\n\nStep 1. Reduce to the \u201codd gcd = 1\u201d case.\nLet d := gcd{xodd : x \u2208 M}, i.e., the gcd of the odd parts of the elements of M. Then d is odd, and every element of M is divisible by d. Define\nS := {x/d : x \u2208 M} \u2286 Z>0.\nBecause d is odd, S also satisfies:\n- (a) s \u2208 S \u21d2 2s \u2208 S,\n- (b) s,t \u2208 S and s+t even \u21d2 (s+t)/2 \u2208 S.\nMoreover, the gcd of the odd parts of S is 1.\n\nThus it suffices to describe all such S; then M = d\u00b7S.\n\nStep 2. S contains an odd number.\nLet m := min S. If m is odd we are done. If m is even, define m1 := (m+2m)/2 = 3m/2. Since m is even, m1 \u2208 S and v2(m1) = v2(m) \u2212 1. Iterating, after finitely many steps we obtain an odd element a \u2208 S.\n\nStep 3. From an odd a \u2208 S, we can \u201cadd\u201d odd parts.\nLet a \u2208 S be odd, and let t \u2208 S be arbitrary. Put y0 := 2t \u2208 S (even) and define\ny_{k+1} := (2a + y_k)/2  for k \u2265 0.\nEach y_k \u2208 S, and a simple induction shows y_k = a + y0/2^k. If we take k = v2(y0) = v2(t)+1, then y_k = a + oddpart(y0) = a + oddpart(t). Hence:\n\nFor every t \u2208 S, we have a + oddpart(t) \u2208 S.\n\nStep 4. S contains all sufficiently large integers.\nLet R be a finite subset of S such that the gcd of {oddpart(r) : r \u2208 R} is 1 (possible since the gcd of odd parts in S is 1). By Step 3, starting from a we can add any oddpart(r) with r \u2208 R, and thus any nonnegative Z-linear combination of those odd parts. Since the numerical semigroup generated by a finite set of positive integers with gcd 1 contains all sufficiently large integers, it follows that all sufficiently large odd integers belong to S. Then any sufficiently large even integer is the average of two consecutive large odd integers, so all sufficiently large integers lie in S. Therefore there exists L0 with [L0, \u221e) \u2286 S.\n\nStep 5. S is actually an upper ray from its minimum.\nLet m = min S. Fix n \u2265 m. Choose k large enough so that\ny := m + 2^k (n \u2212 m) \u2265 L0.\nThen y \u2208 S (by Step 4), and y \u2261 m (mod 2^k). Applying (b) k times to the pair (m, y) (which always has the same parity) gives\nm, y \u21d2 (m+y)/2, then (m + (m+y)/2)/2, \u2026, finally m + (y\u2212m)/2^k = n \u2208 S.\nHence every n \u2265 m lies in S, i.e., S = [m, \u221e) \u2229 Z.\n\nStep 6. Scale back.\nRecall M = d\u00b7S with d odd. Writing m' := min S, we have\nM = {d\u00b7s : s \u2265 m'} = {n \u2208 Z>0 : n \u2265 d m' and d | n}.\nThus M is exactly the set of all multiples of an odd integer d, from some point onwards (with minimal element dm').\n\nVerification (sufficiency).\nGiven odd d \u2265 1 and r \u2265 1, define\nM = {dn : n \u2265 r}.\nThen:\n- If x = dn \u2208 M, 2x = d(2n) \u2208 M.\n- If x = da, y = db \u2208 M and x+y even, then (x+y)/2 = d((a+b)/2) with (a+b)/2 \u2265 r; hence in M.\n\nTherefore, the solutions are precisely these sets.\n\nFinal answer.\nExactly the sets\nM = {n \u2208 Z>0 : n \u2261 0 (mod d) and n \u2265 m},\nwhere d is an odd positive integer and m is a positive multiple of d. Equivalently, for some odd d and some r \u2265 1,\nM = {d\u00b7n : n \u2265 r}."
    ],
    "variant_times": [
      1153.8968420028687,
      460.8557870388031,
      1732.5828008651733
    ],
    "final": "Let v2(n) be the exponent of 2 in n, and write n = 2^{v2(n)}\u00b7odd(n) with odd(n) odd.\n\nClaim (closure under addition). From (a) and (b), M is closed under addition: if a,b \u2208 M then 2a,2b \u2208 M, hence (2a+2b)/2 = a+b \u2208 M.\n\nClaim (existence of an odd element). Let t be the minimum of v2(x) over x \u2208 M, and pick x with v2(x)=t. If t\u22651, then x,2x \u2208 M and (x+2x)/2 = 3x/2 \u2208 M has v2 decreased by 1. Repeating, we reach an odd element of M. Thus M contains an odd element.\n\nNow let d be the gcd of the odd parts odd(x) of elements x \u2208 M. Then d is odd, and d | odd(x) for all x \u2208 M, hence d | x (because d is odd). Thus M \u2286 d\u00b7Z_{>0}.\n\nScale down by d: define S = {x/d : x \u2208 M} \u2286 Z_{>0}. Then S is nonempty and satisfies (a) and (b), and the gcd of the odd parts in S equals 1. We will show that S is an upper ray: there exists m such that S = {n \u2208 Z_{>0} : n \u2265 m}.\n\n1) S contains an odd element (by the same v2-reduction argument). Let o be the least odd element of S. Because the gcd of odd parts in S is 1, the gcd of all odd elements of S is 1. Therefore, we can choose finitely many odd elements a1=o, a2, \u2026, ak \u2208 S with gcd(a1,\u2026,ak)=1.\n\n2) S contains all sufficiently large integers. For each residue r \u2208 {0,1,\u2026,a1\u22121}, because the classes of a2,\u2026,ak generate Z/a1Z (gcd is 1), there exist coefficients t2,\u2026,tk with 0 \u2264 ti < a1 such that\nt2 a2 + \u2026 + tk ak \u2261 r (mod a1).\nSet m_r = t2 a2 + \u2026 + tk ak \u2208 S. Let L = max_r m_r. Then for any n \u2265 L with n \u2261 r (mod a1),\nn = m_r + q a1 (q \u2265 0),\nand since S is closed under addition and contains a1, we have n \u2208 S. Hence [L, \u221e) \u2286 S.\n\n3) S is actually the full upper ray from its minimum. Let m = min S. Fix any n \u2265 m. Choose k large enough so that y := m + 2^k (n \u2212 m) \u2265 L. Then y \u2208 S by step 2, and y \u2261 m (mod 2^k). Applying (b) repeatedly to the pair (m, y): set\nz_1 = (m + y)/2, z_2 = (m + z_1)/2, \u2026, z_k = m + (y \u2212 m)/2^k = n.\nAt each step the two arguments have the same parity (since y \u2261 m mod 2^k), so each averaging is allowed. Thus n \u2208 S. Therefore S = {n \u2208 Z_{>0} : n \u2265 m}.\n\nFinally, scaling back, M = d\u00b7S = {d n : n \u2265 m}. Writing r = m, we obtain\nM = {n \u2208 Z_{>0} : n \u2261 0 (mod d) and n \u2265 dr},\nwith d an odd integer and r \u2265 1.\n\nVerification (sufficiency). For odd d and r \u2265 1, the set M = {d n : n \u2265 r} satisfies:\n- (a) If x = d n \u2208 M then 2x = d(2n) \u2208 M.\n- (b) If x = d a, y = d b \u2208 M and x + y is even, then a and b have the same parity, so (x + y)/2 = d((a + b)/2) with (a + b)/2 \u2265 r, hence in M.\n\nTherefore these are exactly the desired subsets.\n\nFinal answer.\nThe nonempty subsets M \u2286 Z_{>0} satisfying (a) and (b) are precisely\nM = {d n : n \u2265 r},\nfor some odd integer d \u2265 1 and some integer r \u2265 1.",
    "final_time": 376.2462658882141,
    "total_problem_time": 3723.581695795059
  },
  {
    "id": "problem_8",
    "round": "Day 2",
    "variants": [
      "Let A = (a_{ij}) \u2208 M_n(\u211d). The 90\u00b0 counterclockwise rotation satisfies\n(A^R)_{ij} = a_{j, n+1-i}.\n\nAssume A = A^R. Then for all i, j,\n(1) a_{ij} = a_{j, n+1-i}.\n\nApplying the rotation twice gives the 180\u00b0 rotation, whose effect on entries is\n((A^R)^R)_{ij} = a_{n+1-i, n+1-j}.\nSince A = (A^R)^R as well, we also have\n(2) a_{ij} = a_{n+1-i, n+1-j}.\n\nWe claim A is symmetric, i.e. a_{ij} = a_{ji}. Using (2) with swapped indices gives\na_{ij} = a_{n+1-j, n+1-i}.\nApplying (1) to the pair (n+1-j, n+1-i) yields\na_{n+1-j, n+1-i} = a_{n+1-i, j}.\nThus a_{ij} = a_{n+1-i, j}. Applying (1) again to the pair (n+1-i, j) gives\na_{n+1-i, j} = a_{j, i}.\nTherefore a_{ij} = a_{ji}, proving A is symmetric.\n\nSince A is a real symmetric matrix, it is Hermitian, and hence all its eigenvalues are real. In particular, for any eigenvalue \u03bb of A, Im \u03bb = 0 (and thus Re \u03bb = 0 or Im \u03bb = 0 holds).\n\nFinal answer: All eigenvalues of A are real; in particular, Im \u03bb = 0 for every eigenvalue \u03bb.",
      "Let J be the n\u00d7n reversal (anti-identity) matrix, J = [\u03b4i,n+1\u2212j]. For any X\u2208Mn(R) one checks directly\n(X^R)ij = xj,n+1\u2212i, hence X^R = J X^T.\n\nThus A = A^R is equivalent to\nA = J A^T.                                             (1)\n\nFrom (1), taking transpose gives A^T = A J, and multiplying by J on the left yields\nJ A^T = J A J. Using (1) again, J A^T = A, so\nJ A J = A, i.e. A commutes with J.                     (2)\n\nSince J is real symmetric with eigenvalues \u00b11, there exists an orthogonal Q such that\nQ^T J Q = D := diag(Ir, \u2212Is), with r + s = n.\nLet M := Q^T A Q. Then (2) implies D M D = M, so M commutes with D. Writing M in 2\u00d72 block form conformal with D,\nM = [ M11  M12\n      M21  M22 ],\nthe commutation D M = M D forces M12 = 0 and M21 = 0, i.e.\nM = diag(B, C) for some real B (r\u00d7r) and C (s\u00d7s).\n\nNow transform (1) into this basis:\nM = Q^T A Q = Q^T J A^T Q = (Q^T J Q) (Q^T A Q)^T = D M^T.\nWith M = diag(B, C) and D = diag(Ir, \u2212Is), this becomes\ndiag(B, C) = diag(B^T, \u2212C^T),\nso\nB = B^T (symmetric) and C = \u2212C^T (skew-symmetric).\n\nTherefore A is orthogonally similar to a block-diagonal matrix with one real symmetric block and one real skew-symmetric block. The eigenvalues of a real symmetric matrix are real, while the eigenvalues of a real skew-symmetric matrix are purely imaginary (including possibly 0). Hence every eigenvalue \u03bb of A is either real or purely imaginary.\n\nFinal answer.\nFor any A with A = A^R, its spectrum is the disjoint union of the spectra of a real symmetric and a real skew-symmetric matrix; thus each eigenvalue \u03bb satisfies either Re \u03bb = 0 or Im \u03bb = 0.",
      "Let J denote the n\u00d7n reversal matrix (ones on the anti-diagonal, zeros elsewhere). Then for any A we have\nA^R = J A^T.\nIndeed, (J A^T)_{i,j} = A_{j,n+1-i}, which is exactly the 90\u00b0 counterclockwise rotation of entries.\n\nHence the condition A = A^R is equivalent to\nA = J A^T.\n\nFrom this,\n- multiplying on the left by J gives J A = A^T,\n- taking transpose gives A^T = A J.\n\nCombining, we get J A = A J; thus A commutes with J.\n\nSince J is real symmetric with J^2 = I, the spectral theorem yields an orthogonal matrix Q such that\nQ^T J Q = diag(I_p, -I_q) =: D,\nwhere p = ceil(n/2) and q = floor(n/2). Set\nS := Q^T A Q.\n\nBecause A commutes with J, S commutes with D:\nD S = S D.\nWriting S in p\u00d7p, p\u00d7q, q\u00d7p, q\u00d7q blocks as S = [B F; G C], the commutation D S = S D reads\n[B F; -G -C] = [B -F; G -C],\nso F = 0 and G = 0. Therefore S is block diagonal:\nS = [B 0; 0 C].\n\nNow translate A = J A^T into this basis:\nS = Q^T A Q = Q^T J A^T Q = (Q^T J Q)(Q^T A Q)^T = D S^T.\nThus\n[B 0; 0 C] = [B^T 0; 0 -C^T],\nso B is symmetric (B = B^T) and C is skew-symmetric (C^T = -C).\n\nConsequently, all eigenvalues of B are real (B real symmetric), and all eigenvalues of C are purely imaginary (C real skew-symmetric). Hence all eigenvalues of S, and thus of A (being orthogonally similar to S), are either real or purely imaginary.\n\nFinal answer: Every eigenvalue \u03bb of A is real or purely imaginary; i.e., Re \u03bb = 0 or Im \u03bb = 0."
    ],
    "variant_times": [
      205.66587281227112,
      121.8278238773346,
      54.007139921188354
    ],
    "final": "Let J be the n\u00d7n reversal (anti-identity) matrix, with ones on the anti-diagonal and zeros elsewhere. A direct entrywise check shows\n(A^R)_{ij} = a_{j,\\,n+1-i} = (J A^T)_{ij},\nso A^R = J A^T. Hence the condition A = A^R is equivalent to\nA = J A^T.                                          (1)\n\nTransposing (1) gives A^T = A J (since J^T = J). Left-multiplying (1) by J and using J^2 = I yields\nJ A^T = A and thus A = J A J,\nso A commutes with J:\nA J = J A.                                          (2)\n\nBecause J is real symmetric with J^2 = I, there exists an orthogonal Q such that\nQ^T J Q = D := diag(I_r, -I_s), with r + s = n.\nSet M := Q^T A Q. From (2) we get D M = M D, so in a block form compatible with D we have\nM = [ B  0\n      0  C ].\nNow rewrite (1) in this basis:\nM = Q^T A Q = Q^T J A^T Q = (Q^T J Q)(Q^T A Q)^T = D M^T.\nTherefore\ndiag(B, C) = diag(B^T, -C^T),\nso B = B^T (symmetric) and C = -C^T (skew-symmetric).\n\nHence A is orthogonally similar to a block-diagonal matrix with one real symmetric block and one real skew-symmetric block. The eigenvalues of a real symmetric matrix are real, and those of a real skew-symmetric matrix are purely imaginary (possibly 0). Therefore every eigenvalue \u03bb of A is either real or purely imaginary.\n\nFinal answer.\nFor any A with A = A^R, each eigenvalue \u03bb satisfies Re \u03bb = 0 or Im \u03bb = 0.",
    "final_time": 51.91755127906799,
    "total_problem_time": 433.41838788986206
  },
  {
    "id": "problem_9",
    "round": "Day 2",
    "variants": [
      "Let Rj be the rank of Xj among the remaining positive integers at step j (i.e., Rj=1 means we pick the smallest remaining number, Rj=2 the second smallest, etc.). By the rule of the process, for every step j and every i\u22651 we have\nP(Rj=i)=2\u2212i,\nindependently of the past. Hence the Rj are i.i.d. with this distribution.\n\n1) Distribution of Yn\nFor m\u22650, the event Yn\u2264m means that all n chosen numbers lie in {1,\u2026,m}. Equivalently, at step j (1\u2264j\u2264n) the rank Rj must be at most the number of remaining elements in {1,\u2026,m}, which equals m\u2212(j\u22121). Thus, for m\u2265n\u22121,\nP(Yn\u2264m)=\u220fj=1nP(Rj\u2264m\u2212j+1)=\u220fj=1n(1\u22122\u2212(m\u2212j+1)).\nFor m\u2264n\u22121, this probability is 0, as one cannot fit n distinct numbers into a set of size m.\n\n2) Tail-sum for the expectation\nUsing E[Yn]=\u2211m\u22651P(Yn\u2265m), and noting P(Yn\u2265m)=1 for m\u2264n, we get\nE[Yn]=n+\u2211m\u2265n+1[1\u2212\u220fj=1n(1\u22122\u2212(m\u2212j))].\nReindex with t=m\u2212n\u22651 and set q=1/2 to write\nE[Yn]=n+\u2211t\u22651[1\u2212\u220fk=0n\u22121(1\u2212q^{t+k})].\n\n3) A q-identity\nDefine for 0<q<1\nSn(q):=\u2211t\u22651[1\u2212\u220fk=0n\u22121(1\u2212q^{t+k})].\nWe claim Sn(q)=\u2211i=1n q^{i}/(1\u2212q^{i}). This can be proved by induction on n by showing\nSn(q)\u2212Sn\u22121(q)=q^{n}/(1\u2212q^{n}).\nIndeed,\nSn\u2212Sn\u22121=\u2211t\u22651\u220fk=0n\u22122(1\u2212q^{t+k})\u2212\u220fk=0n\u22121(1\u2212q^{t+k})\n=\u2211t\u22651q^{t+n\u22121}\u220fk=0n\u22122(1\u2212q^{t+k}).\nLet At:=\u220fk=0n\u22121(1\u2212q^{t+k}). A simple difference identity gives\nAt\u2212At\u22121=q^{t\u22121}(1\u2212q^{n})\u220fk=0n\u22122(1\u2212q^{t+k}),\nhence\nq^{t}\u220fk=0n\u22122(1\u2212q^{t+k})=q[At\u2212At\u22121]/(1\u2212q^{n}).\nSumming over t\u22651 and using telescoping (A0=0, limt\u2192\u221eAt=1) yields\n\u2211t\u22651q^{t}\u220fk=0n\u22122(1\u2212q^{t+k})=q/(1\u2212q^{n}),\nand therefore Sn\u2212Sn\u22121=q^{n}/(1\u2212q^{n}). Since S1(q)=q/(1\u2212q), the induction gives\nSn(q)=\u2211i=1n q^{i}/(1\u2212q^{i}).\n\n4) Conclusion\nWith q=1/2 we obtain\nE[Yn]=n+\u2211i=1n 2\u2212i/(1\u22122\u2212i)=\u2211i=1n 2^{i}/(2^{i}\u22121).\n\nFinal answer.\nE[Yn]=\u2211i=1n 2^{i}/(2^{i}\u22121).",
      "Let Z1 < Z2 < \u2026 < Zn be the selected numbers in increasing order (the order statistics of X1,\u2026,Xn). Set Z0 := 0 and define the gaps Gj := Zj \u2212 Zj\u22121 for j = 1,\u2026,n. Then Yn = Zn = G1 + \u22ef + Gn.\n\nKey observation (block-avoidance probability).\nFix s \u2265 1. At any time, if none of the first s remaining integers has been chosen yet, then the probability that the next pick avoids this block equals\nsum_{i\u2265s+1} 2^{-i} = 2^{-s}.\nMoreover, as long as the block remains untouched, this avoidance probability stays 2^{-s} at every step. Hence, for r upcoming picks, the probability that all r picks avoid this block is (2^{-s})^r.\n\nDistribution of the first gap G1.\nFor k \u2265 1, the event {G1 \u2265 k} means that none of the first k\u22121 positive integers is chosen among the n selections. By the observation with s = k\u22121 and r = n, we get\nP(G1 \u2265 k) = (2^{-(k-1)})^n = 2^{-n(k-1)}.\nThus G1 is geometric (on {1,2,\u2026}) with parameter p = 1 \u2212 2^{-n}, i.e.\nP(G1 = k) = (1 \u2212 2^{-n}) 2^{-n(k-1)}, and E[G1] = 1/p = 2^n/(2^n \u2212 1).\n\nDistribution of general gaps Gj.\nCondition on Z1,\u2026,Zj\u22121. There remain r = n \u2212 j + 1 selections to be made from the remaining integers, and consider the block of the next s integers after Zj\u22121, i.e., {Zj\u22121+1,\u2026,Zj\u22121+s}. The event {Gj \u2265 s+1} is exactly that none of these r remaining picks hits this block. By the same observation,\nP(Gj \u2265 s+1 | Z1,\u2026,Zj\u22121) = (2^{-s})^r = 2^{-s(n\u2212j+1)}.\nTherefore, unconditionally,\nP(Gj \u2265 t) = 2^{-(t-1)(n\u2212j+1)} for t = 1,2,\u2026,\nso Gj is geometric with parameter pj = 1 \u2212 2^{-(n\u2212j+1)} and\nE[Gj] = 1/pj = 2^{n\u2212j+1}/(2^{n\u2212j+1} \u2212 1).\n\nTaking expectations and summing:\nE[Yn] = E[Z_n] = \u2211_{j=1}^{n} E[Gj]\n= \u2211_{j=1}^{n} 2^{n\u2212j+1}/(2^{n\u2212j+1} \u2212 1)\n= \u2211_{i=1}^{n} 2^{i}/(2^{i} \u2212 1),\n\nas claimed.\n\nFinal answer.\nE[Y_n] = \u2211_{i=1}^{n} 2^{i}/(2^{i} \u2212 1).",
      "Let us realize the selection rule as follows: at each step, list the remaining integers in increasing order and, independently, flip a fair coin for each (in that order) until the first Head appears; choose that integer. This gives exactly\nP(\u201cchoose the i-th smallest remaining\u201d) = (1/2)^i,\nas required.\n\n1) Tail probabilities of the maximum.\nFor k \u2265 1, the event {Y_n < k} means that in each of the n stages we select from the remaining numbers less than k. If before stage j we have selected only numbers < k, then there remain exactly k\u2212j numbers less than k, which occupy the first k\u2212j positions in the ordered remaining list. Thus the probability that at stage j we again choose a number < k is\n\u2211_{i=1}^{k-j} 2^{-i} = 1 \u2212 2^{-(k-j)}.\nTherefore, for k \u2265 n+1,\nP(Y_n < k) = \u220f_{j=1}^{n} (1 \u2212 2^{-(k-j)}) = \u220f_{r=k-n}^{k-1} (1 \u2212 2^{-r}),\nand for k \u2264 n we have P(Y_n < k) = 0.\n\nHence\nE[Y_n] = \u2211_{k=1}^{\u221e} P(Y_n \u2265 k) = \u2211_{k=1}^{n} 1 + \u2211_{k=n+1}^{\u221e} (1 \u2212 \u220f_{r=k-n}^{k-1} (1 \u2212 2^{-r})).\n\n2) Increment of the expectation.\nConsider the difference E[Y_n] \u2212 E[Y_{n-1}] = \u2211_{k=1}^{\u221e} (P(Y_n \u2265 k) \u2212 P(Y_{n-1} \u2265 k)) = \u2211_{k=1}^{\u221e} (P(Y_{n-1} < k) \u2212 P(Y_n < k)).\n\nFor k \u2265 n,\nP(Y_{n-1} < k) = \u220f_{r=k-n+1}^{k-1} (1 \u2212 2^{-r}),  and\nP(Y_n < k) = (1 \u2212 2^{-(k-n)}) \u220f_{r=k-n+1}^{k-1} (1 \u2212 2^{-r}),\nso\nP(Y_{n-1} < k) \u2212 P(Y_n < k) = 2^{-(k-n)} \u220f_{r=k-n+1}^{k-1} (1 \u2212 2^{-r}).\n\nLet m = k \u2212 n \u2265 0. Then\nE[Y_n] \u2212 E[Y_{n-1}] = \u2211_{m=0}^{\u221e} 2^{-m} \u220f_{r=m+1}^{m+n-1} (1 \u2212 2^{-r}).\n\nDefine Q_m = \u220f_{r=m+1}^{m+n} (1 \u2212 2^{-r}) (with Q_{-1} = 0). A direct computation gives the telescoping identity\nQ_m \u2212 Q_{m-1} = (1 \u2212 2^{-n}) 2^{-m} \u220f_{r=m+1}^{m+n-1} (1 \u2212 2^{-r}).\nTherefore\nE[Y_n] \u2212 E[Y_{n-1}] = (1/(1 \u2212 2^{-n})) \u2211_{m=0}^{\u221e} (Q_m \u2212 Q_{m-1})\n= (1/(1 \u2212 2^{-n})) (lim_{M\u2192\u221e} Q_M \u2212 Q_{-1}).\n\nSince Q_M = \u220f_{r=M+1}^{M+n} (1 \u2212 2^{-r}) \u2192 1 as M \u2192 \u221e, we conclude\nE[Y_n] \u2212 E[Y_{n-1}] = 1/(1 \u2212 2^{-n}) = 2^n/(2^n \u2212 1).\n\nFinally, with E[Y_0] = 0, summing these increments yields\nE[Y_n] = \u2211_{i=1}^{n} (E[Y_i] \u2212 E[Y_{i-1}]) = \u2211_{i=1}^{n} 2^i/(2^i \u2212 1).\n\nFinal answer.\nE[Y_n] = \u2211_{i=1}^{n} 2^i/(2^i \u2212 1)."
    ],
    "variant_times": [
      178.08189296722412,
      5176.115582942963,
      264.7044279575348
    ],
    "final": "Solution.\n\nRealize the selection rule by ranks: at each step, list the remaining integers in increasing order and pick the i-th smallest remaining with probability 2^{-i}. Equivalently, one can flip a fair coin for each remaining integer in order until the first Head appears; the chosen integer is exactly the i-th remaining when the first Head occurs at flip i. Thus, at each step and independently of the past, the event \u201cwe avoid the first s remaining integers\u201d has probability\nsum_{i \\ge s+1} 2^{-i} = 2^{-s}.\n\nLet Z_1 < Z_2 < \u2026 < Z_n be the selected numbers in increasing order, set Z_0=0, and define the gaps G_j := Z_j - Z_{j-1} (j=1,\u2026,n). Then Y_n = Z_n = G_1 + \u2026 + G_n.\n\nFix j and condition on Z_1,\u2026,Z_{j-1}. There remain r = n - j + 1 selections. The event {G_j \u2265 t} means that none of the r remaining picks hits the block of the first t-1 integers after Z_{j-1}. As long as this block is untouched, at each of those r steps the probability to avoid it equals 2^{-(t-1)}, and these avoidance events are independent across steps. Hence\nP(G_j \u2265 t | Z_1,\u2026,Z_{j-1}) = (2^{-(t-1)})^r = 2^{-(t-1)(n-j+1)}.\nThis does not depend on the conditioning, so unconditionally\nP(G_j \u2265 t) = 2^{-(t-1)(n-j+1)},  t=1,2,\u2026,\ni.e. G_j is geometric on {1,2,\u2026} with parameter p_j = 1 - 2^{-(n-j+1)}. Therefore\nE[G_j] = 1/p_j = 2^{n-j+1}/(2^{n-j+1} - 1).\n\nSumming expectations,\nE[Y_n] = E[Z_n] = \u2211_{j=1}^{n} E[G_j]\n= \u2211_{j=1}^{n} 2^{n-j+1}/(2^{n-j+1} - 1)\n= \u2211_{i=1}^{n} 2^{i}/(2^{i} - 1).\n\nFinal answer.\nE[Y_n] = \u2211_{i=1}^{n} 2^{i}/(2^{i} - 1).",
    "final_time": 85.24470496177673,
    "total_problem_time": 5704.146608829498
  },
  {
    "id": "problem_10",
    "round": "Day 2",
    "variants": [
      "Let t(n) = n(n+1). For a prime p, denote by vp(n) the p-adic valuation. Because n and n+1 are coprime, vp(t(n)) = vp(n) + vp(n+1) equals the valuation of whichever of n,n+1 is divisible by p. Let Ep(n) be the parity (mod 2) of vp(t(n)). Then for fixed p, Ep(n) = 1 if and only if vp of the divisible one is odd.\n\nA local computation (using the geometric distribution of valuations) gives, for every prime p,\nP(Ep(n) = 1) = 2 \u2211_{r odd \u2265 1} (1/p^r \u2212 1/p^{r+1}) = 2/(p+1).\nThus P(Ep(n) = 0) = (p\u22121)/(p+1).\n\nFor two independent integers a,b (uniformly in [1,N]), the condition that t(a)t(b) is a perfect square is equivalent to Ep(a) = Ep(b) for every prime p, and for large N it suffices to check primes p \u2264 N+1 (since no p > N+1 divides t(a) or t(b)). For a fixed p, the probability of a match is\nMp := P(Ep(a) = Ep(b)) = P(1,1) + P(0,0) = [2/(p+1)]^2 + [(p\u22121)/(p+1)]^2\n= 1 \u2212 4(p\u22121)/(p+1)^2 = 1 \u2212 4/p + O(1/p^2).\n\nWe will extract a lower bound for the proportion of matching pairs using a truncation at a parameter y with 2 \u2264 y \u2264 N. Define the set\nAy := {n \u2264 N : Ep(n) = 0 for all primes p with y < p \u2264 N+1}.\nBy independence of local conditions across distinct primes (via the Chinese Remainder Theorem and standard density arguments), we have\n|Ay| = N \u220f_{y < p \u2264 N+1} P(Ep(n) = 0) + o(N)\n= N \u220f_{y < p \u2264 N+1} (1 \u2212 2/(p+1)) + o(N).\n\nMoreover, among pairs (a,b) \u2208 Ay \u00d7 Ay, the condition t(a)t(b) is a square is already guaranteed at all primes p > y (by the definition of Ay), and for primes p \u2264 y the matching probability is \u220f_{p \u2264 y} Mp. Therefore, the number of such matching pairs satisfies\nS_N \u2265 |Ay|^2 \u220f_{p \u2264 y} Mp + o(N^2).\n\nWe now estimate these products using Mertens\u2019 theorem for primes. Recall that\n\u2211_{p \u2264 x} 1/p = log log x + B + o(1),\nand hence for fixed \u03b1 one has\n\u220f_{p \u2264 x} (1 \u2212 \u03b1/p) = C(\u03b1) / (log x)^\u03b1 \u00b7 (1 + o(1)),\nfor some positive constant C(\u03b1). Since\n1 \u2212 2/(p+1) = 1 \u2212 2/p + O(1/p^2), and Mp = 1 \u2212 4/p + O(1/p^2),\nwe obtain\n\u220f_{y < p \u2264 N+1} (1 \u2212 2/(p+1)) = C1 \u00b7 (log y / log N)^2 \u00b7 (1 + o(1)),\n\u220f_{p \u2264 y} Mp = C0 \u00b7 (1 / (log y)^4) \u00b7 (1 + o(1)),\nfor positive constants C0, C1.\n\nPlugging these into the lower bound gives\nS_N \u2265 [N \u00b7 C1 (log y / log N)^2]^2 \u00b7 [C0 / (log y)^4] \u00b7 (1 + o(1))\n= (C0 C1^2) \u00b7 N^2 / (log N)^4 \u00b7 (1 + o(1)).\nSince y can be any function with 2 \u2264 y \u2264 N tending to infinity (e.g. y = \u230a\u221aN\u230b), the constant C0 C1^2 is positive and independent of N, so for all large N,\nS_N \u2265 c \u00b7 N^2 / (log N)^4,\nfor some absolute c > 0. Consequently,\nS_N / N \u2265 c \u00b7 N / (log N)^4 \u2192 \u221e as N \u2192 \u221e.\n\nIn particular, the requested limit exists and is infinite.\n\nFinal answer.\n+\u221e",
      "Let s(n) denote the squarefree kernel of n (the product of primes that appear to odd exponent in n). For 1 \u2264 a \u2264 N, set\nr(a) = s(a(a+1)).\nThen (a^2+a)(b^2+b) is a perfect square if and only if s(a(a+1)) = s(b(b+1)). Hence, if\nA_r(N) = #{1 \u2264 a \u2264 N : r(a) = r},\nwe have\nS_N = \u2211_r A_r(N)^2 = N + 2\u2211_r C(A_r(N),2).\nTherefore it suffices to estimate\nP_N := \u2211_r C(A_r(N),2),\nthe number of unordered pairs {a,b} with 1 \u2264 a < b \u2264 N and r(a) = r(b). We will prove P_N = o(N), which implies S_N = N + o(N) and hence S_N/N \u2192 1.\n\n1) Pell-type parameterization\nFix a squarefree integer r. The condition r(a) = r is equivalent to\na(a+1) = r t^2\nfor some integer t \u2265 1. Writing u = 2a+1, this becomes\nu^2 - 4r t^2 = 1,  with u odd, a = (u-1)/2.\nThus for each fixed r, the u that arise are the u-coordinates of the solutions to the Pell equation\nu^2 - D t^2 = 1,  with D = 4r \u2265 8 (since r \u2265 2; note a(a+1) cannot be a square as a and a+1 are coprime).\nLet u_1 be the least u > 1 (necessarily odd) for which u^2 - D t^2 = 1 has an integer solution. All solutions are given by\nu_m + t_m\u221aD = (u_1 + t_1\u221aD)^m,  m = 1,2,3,\u2026\nIn particular, the sequence (u_m) satisfies the recurrence u_{m+1} = 2u_1 u_m \u2212 u_{m-1}, and one has the identity\nu_m = T_m(u_1),\nwhere T_m is the Chebyshev polynomial of the first kind. A simple induction using T_{m+1}(x) = 2x T_m(x) \u2212 T_{m-1}(x) shows that for x \u2265 1,\nT_m(x) \u2265 x^m  for all m \u2265 1.\nTherefore, for each r, if A_r(N) \u2265 m (i.e., there are at least m values of a \u2264 N in this class), then\nu_m \u2264 2N + 1  \u21d2  u_1^m \u2264 u_m \u2264 2N+1  \u21d2  u_1 \u2264 (2N+1)^{1/m}.\n\n2) Counting r with many solutions\nLet T_m(N) be the number of squarefree r for which A_r(N) \u2265 m. From the conclusion above, for each such r there exists an odd u_1 \u2264 (2N+1)^{1/m} and integers t_1 \u2265 1 such that\n4r t_1^2 = u_1^2 - 1.\nThus, for a fixed odd u, the admissible r are the squarefree parts of (u^2 \u2212 1)/4. The number of such r is at most the number of squarefree divisors of (u^2 \u2212 1)/4, which is \u2264 \u03c4((u^2 \u2212 1)/4), where \u03c4 is the divisor function. Consequently,\nT_m(N) \u2264 \u2211_{odd u \u2264 (2N+1)^{1/m}} \u03c4((u^2 \u2212 1)/4).\nUsing the well-known bound \u03c4(n) \u2264 n^\u03b5 for any \u03b5 > 0 and all sufficiently large n, and noting that (u^2 \u2212 1)/4 \u2264 u^2, we get, for any fixed \u03b5 > 0,\nT_m(N) \u226a \u2211_{u \u2264 c N^{1/m}} u^{2\u03b5} \u226a N^{1/m + 2\u03b5}.\nSince \u03b5 > 0 is arbitrary, we can write succinctly\nT_m(N) \u2264 N^{1/m + o(1)}.\n\n3) Bounding P_N\nWrite\nP_N = \u2211_r C(A_r(N),2) = \u2211_{m \u2265 2} (m \u2212 1) T_m(N).\n(The identity follows by counting, for each class with size A, the number of pairs as C(A,2) = \u2211_{m=2}^A (m \u2212 1).)\nUsing the estimate for T_m(N),\nP_N \u2264 \u2211_{m \u2265 2} (m \u2212 1) N^{1/m + o(1)} = N^{1/2 + o(1)} + N^{1/3 + o(1)} + N^{1/4 + o(1)} + \u2026 = N^{1/2 + o(1)}.\nTherefore P_N = o(N), and hence\nS_N = N + 2P_N = N + o(N).\n\nIt follows that the limit exists and equals 1:\nlim_{N\u2192\u221e} S_N / N = 1.\n\nFinal answer: 1.",
      "Let r(n) denote the squarefree kernel of n(n+1). Since gcd(n,n+1)=1, r(n) is the product of the primes that divide n or n+1 to an odd exponent. Then the condition that (a^2+a)(b^2+b) is a perfect square is equivalent to r(a)=r(b). Hence, if we define\n- c_k(N) := #{1 \u2264 a \u2264 N : r(a)=k} for squarefree k,\nthen\nS_N = \u2211_k c_k(N)^2.\n\nIn particular, S_N \u2265 \u2211_k c_k(N) = N (the diagonal pairs a=b). We will show that the off-diagonal contribution S_N \u2212 N is o(N), which will imply\nlim_{N\u2192\u221e} S_N/N = 1.\n\n1) Reduction to Pell equations. For a given squarefree k, the condition r(a)=k is equivalent to\na(a+1) = k t^2\nfor some integer t. Multiplying by 4 and setting X=2a+1, Y=2t, we obtain\nX^2 \u2212 k Y^2 = 1,\nwith X odd. Conversely, any solution (X,Y) of X^2 \u2212 k Y^2 = 1 has X odd and Y even (for k odd this is forced mod 2; for k even it holds mod 8), so a=(X\u22121)/2 is an integer with a(a+1)=k (Y/2)^2. Thus\nc_k(N) = #{solutions (X,Y) of X^2 \u2212 k Y^2 = 1 with 1 \u2264 X \u2264 2N+1}.\n\nLet \u03b5_k = x_1 + y_1\u221ak > 1 be the fundamental unit of the Pell equation X^2 \u2212 k Y^2 = 1. All solutions are given by x_n + y_n\u221ak = \u03b5_k^n (n\u22650). In particular, x_n is increasing with n and x_n \u224d \u03b5_k^n. Hence\nc_k(N) \u2265 t implies \u03b5_k^t \u2272 2N+1,\nmore precisely\nc_k(N) \u2265 t \u21d2 \u03b5_k^t \u2264 4N+1 \u21d2 \u03b5_k \u2264 (4N+1)^{1/t}.   (1)\n\n2) Bounding the number of k with small \u03b5_k. We use a simple counting lemma.\n\nLemma. Let A(X) be the number of squarefree k for which the Pell equation X^2 \u2212 k Y^2 = 1 has a solution with X \u2264 X. Then A(X) \u226a X.\n\nProof. For each such k, choose one solution (x,y) with 1 \u2264 x \u2264 X. Then k = (x^2 \u2212 1)/y^2 is integer, so y^2 | x^2 \u2212 1. For fixed y, the congruence y^2 | x^2 \u2212 1 means x \u2261 \u00b11 mod y^2, giving at most 2\u2308X/y^2\u2309 choices of x in [1,X]. Summing over 1 \u2264 y \u2264 X,\nA(X) \u2264 \u2211_{y=1}^X 2\u2308X/y^2\u2309 \u226a X \u2211_{y=1}^\u221e 1/y^2 + \u2211_{y=1}^X 1 \u226a X.\nThis proves the lemma.\n\nCombining (1) with the lemma, for t \u2265 1,\nA_t(N) := #{k : c_k(N) \u2265 t} \u2264 #{k : \u03b5_k \u2264 (4N+1)^{1/t}} \u226a N^{1/t}.   (2)\n\n3) Bounding the off-diagonal. Using the identity m^2 = \u2211_{t=1}^m (2t\u22121), we have\nS_N = \u2211_k c_k(N)^2 = \u2211_{t=1}^\u221e (2t\u22121) A_t(N).\nSince A_1(N) = #{k : c_k(N) \u2265 1} \u2264 N, and using (2) for t \u2265 2,\nS_N \u2264 N + C \u2211_{t=2}^\u221e (2t\u22121) N^{1/t}\nfor some absolute constant C. The series is dominated by its first term t=2, and one easily checks\n\u2211_{t=2}^\u221e (2t\u22121) N^{1/t} \u226a N^{1/2}.\nThus\nN \u2264 S_N \u2264 N + O(N^{1/2}),\nso S_N = N + o(N), and consequently\nlim_{N\u2192\u221e} S_N/N = 1.\n\nFinal answer.\n1"
    ],
    "variant_times": [
      1150.275822877884,
      396.57182693481445,
      502.2917308807373
    ],
    "final": "Let r(n) denote the squarefree kernel of n, i.e., the product of all primes dividing n to an odd power. Since gcd(a, a+1)=1, the condition that (a^2+a)(b^2+b) is a perfect square is equivalent to\nr(a(a+1)) = r(b(b+1)).\nDefine, for each squarefree r,\nA_r(N) = #{1 \u2264 a \u2264 N : r(a(a+1)) = r}.\nThen\nS_N = \u2211_r A_r(N)^2 = \u2211_r A_r(N) + 2\u2211_r C(A_r(N),2) = N + 2 P_N,\nwhere P_N counts unordered pairs {a,b} with 1 \u2264 a < b \u2264 N and r(a(a+1)) = r(b(b+1)). We will prove P_N = o(N), hence S_N = N + o(N) and S_N/N \u2192 1.\n\n1) Reduction to a Pell equation. For fixed squarefree r, the condition r(a(a+1)) = r is equivalent to\na(a+1) = r t^2\nfor some integer t \u2265 1. Setting u = 2a+1 and noting 4a(a+1) = u^2 \u2212 1, we get the Pell equation\nu^2 \u2212 4 r t^2 = 1,\nwith u odd and u = 2a+1. Thus A_r(N) equals the number of (integer) solutions (u,t) of u^2 \u2212 4 r t^2 = 1 with 1 \u2264 u \u2264 2N+1 and u odd.\n\nLet u_1 > 1 be the smallest u for which u^2 \u2212 4 r t^2 = 1 has a solution. Then all solutions are given by\nu_m + t_m\u221a(4r) = (u_1 + t_1\u221a(4r))^m,  m = 1,2,\u2026\nLet \u03b1 = u_1 + t_1\u221a(4r) > 1. Since (u_1 + t_1\u221a(4r))(u_1 \u2212 t_1\u221a(4r)) = 1, we have u_m = (\u03b1^m + \u03b1^{-m})/2 \u2265 \u03b1^m/2. Hence\nA_r(N) \u2265 m \u21d2 u_m \u2264 2N+1 \u21d2 \u03b1^m \u2264 2 u_m \u2264 4N+2 \u21d2 u_1 < \u03b1 \u2264 (4N+2)^{1/m}.     (\u2217)\n\n2) Bounding how many r have many a. For m \u2265 2, let\nT_m(N) := #{squarefree r : A_r(N) \u2265 m}.\nBy (\u2217), for each r counted in T_m(N) we have u_1 \u2264 (4N+2)^{1/m}. The map r \u21a6 u_1 is injective: indeed, from u_1^2 \u2212 1 = 4 r t_1^2 one sees r is the squarefree kernel of (u_1^2 \u2212 1)/4, uniquely determined by u_1. Therefore\nT_m(N) \u2264 #{odd u \u2264 (4N+2)^{1/m}} \u226a N^{1/m}.\n\n3) Bounding the off-diagonal. Using C(A,2) = \u2211_{m=2}^A (m\u22121), we get\nP_N = \u2211_r C(A_r(N),2) = \u2211_{m=2}^\u221e (m\u22121) T_m(N)\n\u226a \u2211_{m=2}^\u221e (m\u22121) N^{1/m} = O(N^{1/2}),\nsince the series is dominated by the m=2 term and the tail is O(N^{1/3}).\n\nConsequently, S_N = N + 2P_N = N + O(N^{1/2}) = N + o(N), and hence\nlim_{N\u2192\u221e} S_N / N = 1.\n\nFinal answer.\n1",
    "final_time": 238.07835507392883,
    "total_problem_time": 2287.2177357673645
  },
  {
    "timing_summary": {
      "model_name": "gpt",
      "total_model_time": 16698.38708090782,
      "problems_count": 10,
      "average_time_per_problem": 1669.8387080907821
    }
  }
]